const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=[window.OC.filePath('text', '', 'js/PublicFilesEditor-CwenkHKB.chunk.mjs'),window.OC.filePath('text', '', 'js/index-6AQ8QgJK.chunk.mjs'),window.OC.filePath('text', '', 'js/emoji-picker-DwlFXcXb.chunk.mjs'),window.OC.filePath('text', '', 'js/NcNoteCard-C6xb7vi0-V0bGpS3H.chunk.mjs'),window.OC.filePath('text', '', 'js/index-DfiDB3im.chunk.mjs'),window.OC.filePath('text', '', 'js/vue.runtime.esm-CuYTBykc.chunk.mjs'),window.OC.filePath('text', '', 'js/NcLoadingIcon-CEAyVu2t.chunk.mjs'),window.OC.filePath('text', '', 'css/NcLoadingIcon-Bs0OvbBQ.chunk.css'),window.OC.filePath('text', '', 'css/NcNoteCard-C6xb7vi0-C557o3LO.chunk.css'),window.OC.filePath('text', '', 'js/_plugin-vue2_normalizer-XSZyZ-Zg.chunk.mjs'),window.OC.filePath('text', '', 'js/RichWorkspace-DBFrVg0j.chunk.mjs'),window.OC.filePath('text', '', 'js/Editor.singleton-Dr64dWul.chunk.mjs'),window.OC.filePath('text', '', 'js/RichTextReader-BtigY_oY.chunk.mjs'),window.OC.filePath('text', '', 'js/BaseReader-D4RFpKB3.chunk.mjs'),window.OC.filePath('text', '', 'js/useEditorMethods-B_bwXkGS.chunk.mjs'),window.OC.filePath('text', '', 'js/NcCheckboxRadioSwitch-VeztTzpz-DqrPZaxq.chunk.mjs'),window.OC.filePath('text', '', 'css/NcCheckboxRadioSwitch-VeztTzpz-CdJ-sA3l.chunk.css'),window.OC.filePath('text', '', 'js/logger-DVPLBGl3.chunk.mjs'),window.OC.filePath('text', '', 'js/MediaHandler.provider-DV_yetSH.chunk.mjs'),window.OC.filePath('text', '', 'css/useEditorMethods-DMz9A7qr.chunk.css'),window.OC.filePath('text', '', 'css/BaseReader-BGxamrxR.chunk.css'),window.OC.filePath('text', '', 'css/RichTextReader-ogAdndrQ.chunk.css'),window.OC.filePath('text', '', 'css/RichWorkspace-DySIGUqv.chunk.css')])))=>i.map(i=>d[i]);
import{_ as u,a as w,e as f}from"./index-6AQ8QgJK.chunk.mjs";import{g as E,s as x,a as I}from"./NcNoteCard-C6xb7vi0-V0bGpS3H.chunk.mjs";import{H as y,a as A,N as F}from"./index-BjvIWxeO.chunk.mjs";import{h as R,c as g}from"./NcLoadingIcon-CEAyVu2t.chunk.mjs";import{l as O}from"./index-DfiDB3im.chunk.mjs";import{V as C}from"./vue.runtime.esm-CuYTBykc.chunk.mjs";import{b as p}from"./mime-DDg3sTIz.chunk.mjs";import{F as D,P as h}from"./dav-DY_3WIBa-wPjnV3No.chunk.mjs";import"./emoji-picker-DwlFXcXb.chunk.mjs";const H='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-text" viewBox="0 0 24 24"><path d="M21,6V8H3V6H21M3,18H12V16H3V18M3,13H21V11H3V13Z" /></svg>',_="Edit with text app",U=()=>{const r=E(),e=document.querySelector("#preview table.files-filestable");if(!r||!e){const a=document.createElement("div");a.id="text-viewer-fallback",document.body.appendChild(a);const n=i=>OCA.Files.fileActions.register(i,_,OC.PERMISSION_UPDATE|OC.PERMISSION_READ,R("core","actions/rename"),c=>{const d=window.FileList.findFile(c);Promise.all([u(()=>import("./vue.runtime.esm-CuYTBykc.chunk.mjs").then(s=>s.z),[],import.meta.url),u(()=>import("./PublicFilesEditor-CwenkHKB.chunk.mjs"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url)]).then(s=>{const k=window.FileList.getCurrentDirectory()+"/"+c,l=s[0].default;l.prototype.t=window.t,l.prototype.n=window.n,l.prototype.OCA=window.OCA;const b=s[1].default;new l({render:v=>v(b,{props:{fileId:d?d.id:null,active:!0,shareToken:r,relativePath:k,mimeType:d.mimetype},on:{close:()=>{(void 0).$destroy()}}})}).$mount(a)})},t("text","Edit"));for(let i=0;i<p.length;i++)n(p[i]),OCA.Files.fileActions.setDefault(p[i],_)}},q=()=>{const r=t("text","Readme")+"."+O("text","default_file_extension");A({id:"rich-workspace-init",displayName:t("text","Add folder description"),category:F.Other,enabled(e){return Number(e.attributes["rich-workspace-file"])?!1:(e.permissions&h.CREATE)!==0},iconSvgInline:H,async handler(e,a){if(a.map(s=>s.basename).includes(r)){x(t("text",'"{name}" already exist!',{name:r}));return}const n=e.encodedSource+"/"+encodeURIComponent(r),i=await g({method:"PUT",url:n,headers:{Overwrite:"F"}}),c=parseInt(i.headers["oc-fileid"]),d=new D({source:e.source+"/"+r,id:c,mtime:new Date,mime:"text/markdown",owner:w()?.uid||null,permissions:h.ALL,root:e?.root||"/files/"+w()?.uid});I(t("text",'Created "{name}"',{name:r})),e.attributes["rich-workspace-file"]=c,e.attributes["rich-workspace"]="",f("files:node:created",d),f("files:node:updated",e)}})};let m,o;const z=new y({id:"workspace",order:10,enabled(r,e){return["files","favorites","public-share"].includes(e.id)},render:async(r,e)=>{m||(m=(await u(()=>import("./RichWorkspace-DBFrVg0j.chunk.mjs"),__vite__mapDeps([10,6,2,5,1,7,3,4,8,11,12,13,14,9,15,16,17,18,19,20,21,22]),import.meta.url)).default),o&&(o.$destroy(),console.debug("Destroying existing FilesHeaderRichWorkspaceInstance"));const a=!!e.attributes["rich-workspace-file"],n=e.attributes["rich-workspace"]||"",i=e.path||"";o=new C({extends:m,propsData:{content:n,hasRichWorkspace:a,path:i}}).$mount(r),window.FilesHeaderRichWorkspaceInstance=o},updated(r){if(!o){console.error("No vue instance found for FilesWorkspaceHeader");return}const e=!!r.attributes["rich-workspace-file"];o.hasRichWorkspace=e,o.content=r.attributes["rich-workspace"]||"",o.path=r.path||""}});export{_ as FILE_ACTION_IDENTIFIER,z as FilesWorkspaceHeader,q as addMenuRichWorkspace,U as registerFileActionFallback};
//# sourceMappingURL=files-VrnC2RwH.chunk.mjs.map
