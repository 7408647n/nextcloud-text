const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=[window.OC.filePath('text', '', 'js/PublicFilesEditor-DMw0h2oD.chunk.mjs'),window.OC.filePath('text', '', 'js/modulepreload-polyfill-CBWYtosv.chunk.mjs'),window.OC.filePath('text', '', 'js/isDarkTheme-CDtFyupZ.chunk.mjs'),window.OC.filePath('text', '', 'js/vue.runtime.esm-D5oVStfN.chunk.mjs'),window.OC.filePath('text', '', 'js/index-HzSm2nlG.chunk.mjs'),window.OC.filePath('text', '', 'js/index-DfiDB3im.chunk.mjs'),window.OC.filePath('text', '', 'js/emoji-picker-_ZUJ6YnW.chunk.mjs'),window.OC.filePath('text', '', 'js/index-HQWwoT4K.chunk.mjs'),window.OC.filePath('text', '', 'css/index-DG0nQhh6.chunk.css'),window.OC.filePath('text', '', 'css/isDarkTheme-qC8o6FCo.chunk.css'),window.OC.filePath('text', '', 'js/RichWorkspace-C1jLJgDC.chunk.mjs'),window.OC.filePath('text', '', 'js/Editor.singleton-Cfh3rmT1.chunk.mjs'),window.OC.filePath('text', '', 'js/RichTextReader-CrV7ZKbc.chunk.mjs'),window.OC.filePath('text', '', 'js/BaseReader-WY5LVJrz.chunk.mjs'),window.OC.filePath('text', '', 'js/EditorOutline-CTpNZe1A.chunk.mjs'),window.OC.filePath('text', '', 'js/_plugin-vue2_normalizer--qmvqNVe-CFuvccDx.chunk.mjs'),window.OC.filePath('text', '', 'js/MediaHandler.provider-BQgMXB6j.chunk.mjs'),window.OC.filePath('text', '', 'js/logger-Csk1_XRx.chunk.mjs'),window.OC.filePath('text', '', 'css/EditorOutline-IPmD4WtQ.chunk.css'),window.OC.filePath('text', '', 'css/BaseReader-bJRmdZA4.chunk.css'),window.OC.filePath('text', '', 'css/RichTextReader-CJ5cj4_P.chunk.css'),window.OC.filePath('text', '', 'css/RichWorkspace-CHQj8JbA.chunk.css')])))=>i.map(i=>d[i]);
import{_ as u}from"./modulepreload-polyfill-CBWYtosv.chunk.mjs";import{p as y,s as A,a as v}from"./_plugin-vue2_normalizer--qmvqNVe-CFuvccDx.chunk.mjs";import{a as f,e as k}from"./index-HQWwoT4K.chunk.mjs";import{d as I,h as O,c as b}from"./index-HzSm2nlG.chunk.mjs";import{H as C,a as R,N as F}from"./index-CWc2CWr8.chunk.mjs";import{l as g}from"./index-DfiDB3im.chunk.mjs";import{b as w}from"./mime-DDg3sTIz.chunk.mjs";import{F as D,P as h}from"./dav-Co9y-hkg-B3N6wqAs.chunk.mjs";import"./emoji-picker-_ZUJ6YnW.chunk.mjs";import"./vue.runtime.esm-D5oVStfN.chunk.mjs";const T='<svg xmlns="http://www.w3.org/2000/svg" id="mdi-text" viewBox="0 0 24 24"><path d="M21,6V8H3V6H21M3,18H12V16H3V18M3,13H21V11H3V13Z" /></svg>',_="Edit with text app",q=()=>{const e=I(),r=document.querySelector("#preview table.files-filestable");if(!e||!r){const a=document.createElement("div");a.id="text-viewer-fallback",document.body.appendChild(a);const p=i=>OCA.Files.fileActions.register(i,_,OC.PERMISSION_UPDATE|OC.PERMISSION_READ,O("core","actions/rename"),l=>{const d=window.FileList.findFile(l);Promise.all([u(()=>import("./vue.runtime.esm-D5oVStfN.chunk.mjs").then(o=>o.x),[],import.meta.url),u(()=>import("./PublicFilesEditor-DMw0h2oD.chunk.mjs"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url)]).then(o=>{const s=window.FileList.getCurrentDirectory()+"/"+l,m=o[0].default;m.prototype.t=window.t,m.prototype.n=window.n,m.prototype.OCA=window.OCA;const E=o[1].default;new m({render:x=>x(E,{props:{fileId:d?d.id:null,active:!0,shareToken:e,relativePath:s,mimeType:d.mimetype},on:{close:()=>{(void 0).$destroy()}}})}).$mount(a)})},t("text","Edit"));for(let i=0;i<w.length;i++)p(w[i]),OCA.Files.fileActions.setDefault(w[i],_)}};let c=!1;const B=()=>{const e=t("text","Readme")+"."+g("text","default_file_extension");R({id:"rich-workspace-init",displayName:t("text","Add folder description"),category:F.Other,enabled(r){return Number(r.attributes["rich-workspace-file"])?!1:(r.permissions&h.CREATE)!==0},iconSvgInline:T,async handler(r,a){const p=a.map(s=>s.basename);if(p.includes(e)){A(t("text",'"{name}" already exist!',{name:e}));return}const i=r.encodedSource+"/"+encodeURIComponent(e),l=await b({method:"PUT",url:i,headers:{Overwrite:"F"}}),d=parseInt(l.headers["oc-fileid"]),o=new D({source:r.source+"/"+e,id:d,mtime:new Date,mime:"text/markdown",owner:f()?.uid||null,permissions:h.ALL,root:r?.root||"/files/"+f()?.uid});v(t("text",'Created "{name}"',{name:e})),p.length===0&&(c=o),k("files:node:created",o)}})};let n=null;const Z=new C({id:"workspace",order:10,enabled(e,r){return["files","favorites","public-share"].includes(r.id)},async render(e,r,a){n&&(n.$destroy(),n=null);const p=!!r.attributes["rich-workspace-file"]||!!c,i=c?y.dirname(c.path):r.path,l=c?"":r.attributes["rich-workspace"];c=!1;const{default:d}=await u(async()=>{const{default:o}=await import("./RichWorkspace-C1jLJgDC.chunk.mjs");return{default:o}},__vite__mapDeps([10,4,5,3,6,7,8,11,1,12,13,14,2,9,15,16,17,18,19,20,21]),import.meta.url);u(()=>import("./vue.runtime.esm-D5oVStfN.chunk.mjs").then(o=>o.x),[],import.meta.url).then(o=>{e.id="files-workspace-wrapper";const s=o.default;s.prototype.t=window.t,s.prototype.n=window.n,s.prototype.OCA=window.OCA;const m=s.extend(d);n=new m({propsData:{path:i,hasRichWorkspace:p,content:l}}).$mount(e)})},updated(e,r){if(c=!1,!n){console.warn("No vue instance found for FilesWorkspaceHeader");return}const a=!!e.attributes["rich-workspace-file"];n.path=e.path,n.hasRichWorkspace=a,n.content=e.attributes["rich-workspace"]}});export{_ as FILE_ACTION_IDENTIFIER,Z as FilesWorkspaceHeader,B as addMenuRichWorkspace,q as registerFileActionFallback};
//# sourceMappingURL=files-CDWl4a1H.chunk.mjs.map
