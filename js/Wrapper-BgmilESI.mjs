/*! third party licenses: js/vendor.LICENSE.txt */
var lt=(e,s,i)=>{if(!s.has(e))throw TypeError("Cannot "+i)};var o=(e,s,i)=>(lt(e,s,"read from private field"),i?i.call(e):s.get(e)),l=(e,s,i)=>{if(s.has(e))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(e):s.set(e,i)},c=(e,s,i,n)=>(lt(e,s,"write to private field"),n?n.call(e,i):s.set(e,i),i);var yt=(e,s,i,n)=>({set _(r){c(e,s,r,i)},get _(){return o(e,s,n)}}),u=(e,s,i)=>(lt(e,s,"access private method"),i);import{d as rt}from"./vue.runtime.esm-Dd7ivler.mjs";import{bv as ft,a7 as Ct,a9 as At,bt as wt,bw as Ht,bx as jt,by as Wt,bz as zt,bA as Kt,bB as qt,bC as Jt,bD as Qt,bE as Gt,bF as Yt,br as Zt,bs as Xt,bG as te,bH as ee}from"./RichText-CfWEvySW.mjs";import{n as x}from"./_plugin-vue2_normalizer-BWKvF6pj.mjs";import{c as St,_ as It,U as se}from"./index-7dlE0du4.mjs";import{g as ie,e as Ot,l as ne}from"./modulepreload-polyfill-DZeoc1eZ.mjs";import{d as $t,s as Nt,m as oe}from"./index-eMgxgA-0.mjs";import{N as bt,x as re,y as gt,z as ae}from"./NcTextArea-XCi8a16Y-CFSsbK92.mjs";import{a as ce,N as le,u as he,z as ht}from"./NcNoteCard-e7-Bxio8-DX1UPUdy.mjs";import{l as de}from"./index-Ubm2itxG.mjs";import{u as at,e as ue,c as Mt,g as Tt,h as pe,d as me,A as ve,r as _e,s as fe,n as be}from"./MediaHandler.provider-2sdLyJv2.mjs";import{l as v}from"./logger-2teHUPfo.mjs";const ye={name:"NcActionButton",components:{NextcloudVueNcActionButton:bt},extends:ft,mounted(){this.$editor.on("transaction",()=>this.updateState())},methods:{runAction(){var s;const{actionEntry:e}=this;e.click?e.click(this):(s=e.action(this.$editor.chain().focus()))==null||s.run(),this.$nextTick(()=>{this.$emit("trigged",{...e})})}}};var ge=function(){var e=this,s=e._self._c;return s("NextcloudVueNcActionButton",e._g({staticClass:"entry-single-action entry-action entry-action-item",class:e.state.class,attrs:{disabled:e.state.disabled,"aria-keyshortcuts":e.keyshortcuts||void 0,"data-text-action-entry":e.actionEntry.key,type:e.state.type,"model-value":e.state.type!=="button"?e.state.active:void 0,"close-after-click":""},on:{click:e.runAction},scopedSlots:e._u([{key:"icon",fn:function(){return[s(e.icon,{tag:"component"})]},proxy:!0}])},e.$listeners),[e._v(" "+e._s(e.label)+" ")])},xe=[],ke=x(ye,ge,xe,!1,null,null,null,null);const Ee=ke.exports,Ce={name:"ActionList",components:{NcActions:ce,NcActionSeparator:Ct,ActionListItem:Ee},extends:ft,mixins:[At,wt,Ht],props:{forceEnabled:{type:Boolean,default:!1}},data:()=>({visible:!1,hasEnabledChild:!0}),computed:{currentChild(){const{state:e,$editor:s,actionEntry:{children:i}}=this;return e.active?i.find(n=>jt(n,s)):null},icon(){return this.currentChild?this.currentChild.icon:this.actionEntry.icon},iconKey(){return"".concat(this.actionEntry.key,"/").concat(this.activeKey)},activeKey(){var e;return(e=this.currentChild)==null?void 0:e.key},children(){return this.actionEntry.children.filter(({visible:e})=>e===void 0?!0:typeof e=="function"?e(this):e)},labelWithSelected(){return this.currentChild?t("text",'{menuItemName}, "{selectedSubMenuItemName}" is selected',{menuItemName:this.actionEntry.label,selectedSubMenuItemName:this.currentChild.label}):this.actionEntry.label},isEnabled(){return this.forceEnabled||this.hasEnabledChild}},mounted(){this.$_updateState=$t(this.checkStateOfChildren.bind(this),50),this.$editor.on("update",this.$_updateState),this.$editor.on("selectionUpdate",this.$_updateState)},beforeDestroy(){this.$editor.off("update",this.$_updateState),this.$editor.off("selectionUpdate",this.$_updateState)},methods:{onOpenChange(e){this.visible=e},runAction(){},onTrigger(e){e!=null&&e.click||(this.$editor.chain().focus().run(),this.$emit("trigged",e))},checkStateOfChildren(){this.hasEnabledChild=this.children.some(e=>this.isChildEnabled(e))},isChildEnabled(e){return!e.isSeparator&&!Wt(e,this.$editor).disabled}}};var Ae=function(){var e=this,s=e._self._c;return s("NcActions",e._b({staticClass:"entry-list-action entry-action",attrs:{title:e.tooltip,container:e.menuIDSelector,"aria-label":e.labelWithSelected,type:e.state.active?"primary":"tertiary","force-menu":!0,"data-text-action-entry":e.actionEntry.key,"data-text-action-active":e.activeKey,disabled:!e.isEnabled},on:{"update:open":e.onOpenChange},scopedSlots:e._u([{key:"icon",fn:function(){return[s(e.icon,{key:e.iconKey,tag:"component"})]},proxy:!0}])},"NcActions",e.state,!1),[e._l(e.children,function(i){var n;return[i.isSeparator?s("NcActionSeparator",{key:"child-".concat(i.key)}):s("ActionListItem",e._g({key:"child-".concat(i.key),attrs:{active:((n=e.currentChild)==null?void 0:n.key)===i.key,"is-item":"","action-entry":i},on:{trigged:e.onTrigger}},e.$listeners))]}),e._t("lastAction",null,null,{visible:e.visible})],2)},we=[],Se=x(Ce,Ae,we,!1,null,null,null,null);const Rt=Se.exports,Ie={name:"ActionSingle",components:{NcButton:le},extends:ft,props:{isItem:{type:Boolean,default:!1}},mounted(){this.$editor.on("transaction",()=>this.updateState())},methods:{runAction(){var s;const{actionEntry:e}=this;e.click?e.click(this):(s=e.action(this.$editor.chain().focus()))==null||s.run(),this.$nextTick(()=>{this.$emit("trigged",{...e})})}}};var Oe=function(){var e=this,s=e._self._c;return s("NcButton",e._g({staticClass:"entry-single-action entry-action",class:e.state.class,attrs:{disabled:e.state.disabled,"aria-keyshortcuts":e.keyshortcuts||void 0,"data-text-action-entry":e.actionEntry.key,"aria-label":e.label,title:e.tooltip,type:"tertiary",pressed:e.state.type!=="button"?e.state.active:void 0},on:{click:e.runAction},scopedSlots:e._u([{key:"icon",fn:function(){return[s(e.icon,{tag:"component"})]},proxy:!0},e.actionEntry.forceLabel?{key:"default",fn:function(){return[e._v(" "+e._s(e.label)+" ")]},proxy:!0}:null],null,!0)},e.$listeners))},$e=[],Ne=x(Ie,Oe,$e,!1,null,null,null,null);const Pt=Ne.exports,Dt=rt({data(){return{activeMenuEntry:0,entries:[]}},computed:{visibleEntries(){return this.entries}},watch:{visibleEntries(){this.$nextTick(()=>{var e;(this.activeMenuEntry>this.visibleEntries.length||(e=this.visibleEntries[this.activeMenuEntry])!=null&&e.disabled)&&this.setNextMenuEntry()})}},methods:{disableMenuEntry(e,s){const i=this.visibleEntries.findIndex(({key:n})=>n===e);this.visibleEntries[i].disabled=s,s===!1&&this.activeMenuEntry===i&&this.$nextTick(()=>this.setNextMenuEntry())},setNextMenuEntry(){const e=this.visibleEntries.length+(this.$refs.remainingEntries?1:0);do this.activeMenuEntry=(this.activeMenuEntry+1)%e;while(this.activeMenuEntry<this.visibleEntries.length&&this.visibleEntries[this.activeMenuEntry].disabled)},setPreviousMenuEntry(){const e=this.visibleEntries.length+(this.$refs.remainingEntries?1:0);do{const s=this.activeMenuEntry-1;this.activeMenuEntry=(s%e+e)%e}while(this.activeMenuEntry<this.visibleEntries.length&&this.visibleEntries[this.activeMenuEntry].disabled)},handleToolbarNavigation(e){var s,i;e.key==="ArrowRight"?this.setNextMenuEntry():e.key==="ArrowLeft"&&this.setPreviousMenuEntry(),this.activeMenuEntry===this.visibleEntries.length?(i=(s=this.$refs.remainingEntries)==null?void 0:s.focusButton)==null||i.call(s):[...this.$refs.menuEntries].sort((n,r)=>this.visibleEntries.findIndex(({key:a})=>a===n.$vnode.data.key)-this.visibleEntries.findIndex(({key:a})=>a===r.$vnode.data.key))[this.activeMenuEntry].focusButton()}}}),Me=rt({name:"ReadonlyBar",components:{ActionList:Rt,ActionSingle:Pt},extends:Dt,data(){return{entries:zt}}});var Te=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("div",{staticClass:"text-readonly-bar",attrs:{"data-text-el":"readonly-bar"}},[s("div",{ref:"menubar",staticClass:"text-readonly-bar__entries",attrs:{role:"toolbar","aria-label":e.t("text","Editor actions")}},e._l(e.visibleEntries,function(i,n){return s(i.component?i.component:i.children?"ActionList":"ActionSingle",{key:i.key,ref:"menuEntries",refInFor:!0,tag:"component",attrs:{"action-entry":i,"can-be-focussed":e.activeMenuEntry===n},on:{disabled:function(r){return e.disableMenuEntry(i.key,r)}}})}),1),s("div",{staticClass:"text-menubar__slot"},[e._t("default")],2)])},Re=[],Pe=x(Me,Te,Re,!1,null,"e1c79b6c",null,null);const Ks=Pe.exports;function De(e){return{all:e=e||new Map,on:function(s,i){var n=e.get(s);n?n.push(i):e.set(s,[i])},off:function(s,i){var n=e.get(s);n&&(i?n.splice(n.indexOf(i)>>>0,1):e.set(s,[]))},emit:function(s,i){var n=e.get(s);n&&n.slice().map(function(r){r(i)}),(n=e.get("*"))&&n.slice().map(function(r){r(s,i)})}}}class Fe extends Error{constructor(s="Close has already been called on the connection",...i){super(s,...i)}}var E,it,Ft;class Le{constructor(s={}){l(this,it);l(this,E,void 0);c(this,E,s)}open({fileId:s,baseVersionEtag:i}){return St.put(u(this,it,Ft).call(this,"session/".concat(s,"/create")),{fileId:s,baseVersionEtag:i,filePath:o(this,E).filePath,token:o(this,E).shareToken,guestName:o(this,E).guestName,forceRecreate:o(this,E).forceRecreate}).then(n=>new Lt(n,o(this,E)))}}E=new WeakMap,it=new WeakSet,Ft=function(s){const i=!!o(this,E).shareToken;return st(s,i)};var z,_t,U,p,b,nt,K,w,S,P,C,N,M,L;class Lt{constructor(s,i){l(this,S);l(this,C);l(this,M);l(this,z,void 0);l(this,_t,void 0);l(this,U,void 0);l(this,p,void 0);l(this,b,void 0);l(this,nt,void 0);l(this,K,void 0);l(this,w,void 0);const{document:n,session:r,lock:a,readOnly:_,content:k,documentState:R}=s.data;c(this,p,n),c(this,b,r),c(this,nt,a),c(this,K,_),c(this,z,k),c(this,U,R),c(this,w,i),this.isPublic=!!i.shareToken,this.closed=!1}get session(){return o(this,b)}get document(){return o(this,p)}get docStateVersion(){return o(this,U)?o(this,p).lastSavedVersion:0}get state(){return{document:{...o(this,p),readOnly:o(this,K)},session:o(this,b),documentSource:o(this,z)||"",documentState:o(this,U)}}sync({version:s}){return u(this,C,N).call(this,u(this,M,L).call(this,"session/".concat(o(this,p).id,"/sync")),{...o(this,S,P),filePath:o(this,w).filePath,baseVersionEtag:o(this,p).baseVersionEtag,version:s})}save({version:s,autosaveContent:i,documentState:n,force:r,manualSave:a}){return u(this,C,N).call(this,u(this,M,L).call(this,"session/".concat(o(this,p).id,"/save")),{...o(this,S,P),filePath:o(this,w).filePath,baseVersionEtag:o(this,p).baseVersionEtag,version:s,autosaveContent:i,documentState:n,force:r,manualSave:a})}push({steps:s,version:i,awareness:n}){return u(this,C,N).call(this,u(this,M,L).call(this,"session/".concat(o(this,p).id,"/push")),{...o(this,S,P),filePath:o(this,w).filePath,baseVersionEtag:o(this,p).baseVersionEtag,steps:s,version:i,awareness:n})}update(s){return u(this,C,N).call(this,u(this,M,L).call(this,"session/".concat(o(this,p).id,"/session")),{...o(this,S,P),guestName:s}).then(({data:i})=>{c(this,b,i)})}uploadAttachment(s){const i=new FormData;i.append("file",s);const n=st("attachment/upload")+"?documentId="+encodeURIComponent(o(this,p).id)+"&sessionId="+encodeURIComponent(o(this,b).id)+"&sessionToken="+encodeURIComponent(o(this,b).token)+"&shareToken="+encodeURIComponent(o(this,w).shareToken||"");return u(this,C,N).call(this,n,i,{headers:{"Content-Type":"multipart/form-data"}})}insertAttachmentFile(s){return u(this,C,N).call(this,st("attachment/filepath"),{documentId:o(this,p).id,sessionId:o(this,b).id,sessionToken:o(this,b).token,filePath:s})}close(){const s=u(this,C,N).call(this,u(this,M,L).call(this,"session/".concat(o(this,p).id,"/close")),o(this,S,P));return this.closed=!0,s}setBaseVersionEtag(s){o(this,p).baseVersionEtag=s}}z=new WeakMap,_t=new WeakMap,U=new WeakMap,p=new WeakMap,b=new WeakMap,nt=new WeakMap,K=new WeakMap,w=new WeakMap,S=new WeakSet,P=function(){return{documentId:o(this,p).id,sessionId:o(this,b).id,sessionToken:o(this,b).token,token:o(this,w).shareToken}},C=new WeakSet,N=function(...s){return this.closed?Promise.reject(new Fe):St.post(...s)},M=new WeakSet,L=function(s){const i=!!o(this,S,P).token;return st(s,i)};function st(e,s=!1){const i=It("/apps/text");return s?"".concat(i,"/public/").concat(e):"".concat(i,"/").concat(e)}const xt=300,Ue=5e3,Be=5e3,Ut=6e4,Ve=5,He=Ut*1.5;var m,q,B,A,D,V,F;class je{constructor(s,i){l(this,m,void 0);l(this,q,void 0);l(this,B,void 0);l(this,A,void 0);l(this,D,void 0);l(this,V,void 0);l(this,F,void 0);c(this,m,s),c(this,q,i),c(this,A,xt),c(this,D,0),c(this,B,0)}connect(){if(this.fetcher>0){console.error("Trying to connect, but already connected");return}c(this,F,!1),this.fetcher=setInterval(this._fetchSteps.bind(this),50),document.addEventListener("visibilitychange",this.visibilitychange.bind(this))}async _fetchSteps(){if(o(this,V))return;const s=Date.now();if(!(o(this,B)>s-o(this,A))){if(!this.fetcher){console.error("No inverval but triggered");return}c(this,V,!0),v.debug("[PollingBackend] Fetching steps",o(this,m).version),await o(this,q).sync({version:o(this,m).version}).then(this._handleResponse.bind(this),this._handleError.bind(this)),c(this,B,Date.now()),c(this,V,!1)}}_handleResponse({data:s}){const{document:i,sessions:n}=s;if(c(this,D,0),o(this,m).emit("change",{document:i,sessions:n}),o(this,m)._receiveSteps(s),s.steps.length===0){if(o(this,F)||c(this,F,!0),o(this,m).checkIdle())return;const r=Date.now()-He;n.filter(a=>a.lastContact*1e3>r).length<2?this.maximumRefetchTimer():this.increaseRefetchTimer(),o(this,m).emit("stateChange",{initialLoading:!0});return}o(this,F)&&this.resetRefetchTimer()}_handleError(s){!s.response||s.code==="ECONNABORTED"?yt(this,D)._++>=Ve?(v.error("[PollingBackend:fetchSteps] Network error when fetching steps, emitting CONNECTION_FAILED"),o(this,m).emit("error",{type:y.CONNECTION_FAILED,data:{}})):v.error("[PollingBackend:fetchSteps] Network error when fetching steps, retry ".concat(o(this,D))):s.response.status===409?(this._handleResponse(s.response),v.error("Conflict during file save, please resolve"),o(this,m).emit("error",{type:y.SAVE_COLLISSION,data:{outsideChange:s.response.data.outsideChange}})):s.response.status===412?(o(this,m).emit("error",{type:y.LOAD_ERROR,data:s.response}),this.disconnect()):s.response.status===403?(o(this,m).emit("error",{type:y.SOURCE_NOT_FOUND,data:{}}),this.disconnect()):s.response.status===404?(o(this,m).emit("error",{type:y.SOURCE_NOT_FOUND,data:{}}),this.disconnect()):s.response.status===503?(this.increaseRefetchTimer(),o(this,m).emit("error",{type:y.CONNECTION_FAILED,data:{}}),v.error("Failed to fetch steps due to unavailable service",{error:s})):(this.disconnect(),o(this,m).emit("error",{type:y.CONNECTION_FAILED,data:{}}),v.error("Failed to fetch steps due to other reason",{error:s}))}disconnect(){clearInterval(this.fetcher),this.fetcher=0,document.removeEventListener("visibilitychange",this.visibilitychange.bind(this))}resetRefetchTimer(){c(this,A,xt)}increaseRefetchTimer(){c(this,A,Math.min(o(this,A)*2,Ue))}maximumRefetchTimer(){c(this,A,Be)}visibilitychange(){document.visibilityState==="hidden"?c(this,A,Ut):this.resetRefetchTimer()}}m=new WeakMap,q=new WeakMap,B=new WeakMap,A=new WeakMap,D=new WeakMap,V=new WeakMap,F=new WeakMap;const We=1440,ze=3e4,qs=60,Ke=90,y={SAVE_COLLISSION:0,PUSH_FAILURE:1,LOAD_ERROR:2,CONNECTION_FAILED:3,SOURCE_NOT_FOUND:4};var T;class Js{constructor({baseVersionEtag:s,serialize:i,getDocumentState:n,...r}){l(this,T,void 0);return this._bus=De(),this.serialize=i,this.getDocumentState=n,this._api=new Le(r),this.connection=null,this.stepClientIDs=[],this.lastStepPush=Date.now(),this.version=null,this.baseVersionEtag=s,this.sending=!1,c(this,T,null),this.autosave=$t(this._autosave.bind(this),ze),this}async open({fileId:s,initialSession:i}){const n=i?Promise.resolve(new Lt({data:i},{})):this._api.open({fileId:s,baseVersionEtag:this.baseVersionEtag}).catch(r=>this._emitError(r));this.connection=await n,this.connection&&(this.backend=new je(this,this.connection),this.version=this.connection.docStateVersion,this.baseVersionEtag=this.connection.document.baseVersionEtag,this.emit("opened",{...this.connection.state,version:this.version}),this.emit("loaded",{...this.connection.state,version:this.version}))}startSync(){this.backend.connect()}syncUp(){this.backend.resetRefetchTimer()}_emitError(s){!s.response||s.code==="ECONNABORTED"?this.emit("error",{type:y.CONNECTION_FAILED,data:{}}):this.emit("error",{type:y.LOAD_ERROR,data:s.response})}updateSession(s){return this.connection.isPublic?this.connection.update(s).catch(i=>(v.error("Failed to update the session",{error:i}),Promise.reject(i))):Promise.reject(new Error)}sendSteps(s){if(!o(this,T))return new Promise((i,n)=>{c(this,T,setInterval(()=>{this.connection&&!this.sending&&this.sendStepsNow(s).then(i).catch(n)},200))})}sendStepsNow(s){this.sending=!0,clearInterval(o(this,T)),c(this,T,null);const i=s();return i.steps.length>0&&this.emit("stateChange",{dirty:!0}),this.connection.push(i).then(n=>{this.sending=!1,this.emit("sync",{steps:[],document:this.connection.document,version:this.version})}).catch(n=>{var _;const{response:r,code:a}=n;throw this.sending=!1,(!r||a==="ECONNABORTED")&&this.emit("error",{type:y.CONNECTION_FAILED,data:{}}),(r==null?void 0:r.status)===412?this.emit("error",{type:y.LOAD_ERROR,data:r}):(r==null?void 0:r.status)===403&&(i.document||v.error("failed to write to document - not allowed"),((_=r.data.document)==null?void 0:_.currentVersion)===this.version&&(this.emit("error",{type:y.PUSH_FAILURE,data:{}}),OC.Notification.showTemporary("Changes could not be sent yet"))),new Error("Failed to apply steps. Retry!",{cause:n})})}_receiveSteps({steps:s,document:i,sessions:n}){const r=[...n.filter(a=>a.lastContact>Math.floor(Date.now()/1e3)-Ke).filter(a=>a.lastAwarenessMessage).map(a=>({step:a.lastAwarenessMessage,clientId:a.clientId}))];for(let a=0;a<s.length;a++){const _=s[a].data;if(this.version<s[a].version&&(this.version=s[a].version),!Array.isArray(_)){v.error("Invalid step data, skipping step",{step:s[a]});continue}_.forEach(k=>{r.push({step:k,clientID:s[a].sessionId})})}this.lastStepPush=Date.now(),this.emit("sync",{steps:r,document:this.connection.document,version:this.version})}checkIdle(){return(Date.now()-this.lastStepPush)/1e3/60>We?(v.debug("[SyncService] Document is idle for ".concat(this.IDLE_TIMEOUT," minutes, suspending connection")),this.emit("idle"),!0):!1}_getContent(){return this.serialize()}async save({force:s=!1,manualSave:i=!0}={}){v.debug("[SyncService] saving",arguments[0]);try{const n=await this.connection.save({version:this.version,autosaveContent:this._getContent(),documentState:this.getDocumentState(),force:s,manualSave:i});this.emit("stateChange",{dirty:!1}),this.connection.document.lastSavedVersionTime=Date.now()/1e3,v.debug("[SyncService] saved",n);const{document:r,sessions:a}=n.data;this.emit("save",{document:r,sessions:a}),this.autosave.clear()}catch(n){throw v.error("Failed to save document.",{error:n}),n}}forceSave(){return this.save({force:!0})}_autosave(){return this.save({manualSave:!1}).catch(s=>{v.error("Failed to autosave document.",{error:s})})}async close(){var s;return this.autosave.clear(),(s=this.backend)==null||s.disconnect(),this._close()}_close(){return this.connection===null?Promise.resolve():(this.backend.disconnect(),this.connection.close())}uploadAttachment(s){return this.connection.uploadAttachment(s)}insertAttachmentFile(s){return this.connection.insertAttachmentFile(s)}on(s,i){return this._bus.on(s,i),this}off(s,i){return this._bus.off(s,i),this}emit(s,i){this._bus.emit(s,i)}}T=new WeakMap;var dt={exports:{}};(function(e,s){Object.defineProperty(s,"__esModule",{value:!0}),s.default=void 0;function i(f){"@babel/helpers - typeof";return i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(d){return typeof d}:function(d){return d&&typeof Symbol=="function"&&d.constructor===Symbol&&d!==Symbol.prototype?"symbol":typeof d},i(f)}var n=47,r=46,a=function(f){var d=i(f);if(d!=="string")throw new TypeError("Expected a string, got a ".concat(d))},_=function(f,d){for(var h="",I=0,O=-1,$=0,W,g=0;g<=f.length;++g){if(g<f.length)W=f.charCodeAt(g);else{if(W===n)break;W=n}if(W===n){if(!(O===g-1||$===1))if(O!==g-1&&$===2){if(h.length<2||I!==2||h.charCodeAt(h.length-1)!==r||h.charCodeAt(h.length-2)!==r){if(h.length>2){var ct=h.lastIndexOf("/");if(ct!==h.length-1){ct===-1?(h="",I=0):(h=h.slice(0,ct),I=h.length-1-h.lastIndexOf("/")),O=g,$=0;continue}}else if(h.length===2||h.length===1){h="",I=0,O=g,$=0;continue}}d&&(h.length>0?h+="/..":h="..",I=2)}else h.length>0?h+="/"+f.slice(O+1,g):h=f.slice(O+1,g),I=g-O-1;O=g,$=0}else W===r&&$!==-1?++$:$=-1}return h},k=function(f){try{return decodeURIComponent(f)}catch{return f}},R=function(f){a(f);var d=f;if(d.length===0)return".";var h=d.charCodeAt(0)===n,I=d.charCodeAt(d.length-1)===n;return d=k(d),d=_(d,!h),d.length===0&&!h&&(d="."),d.length>0&&I&&(d+="/"),h?"/"+d:d},Vt=R;s.default=Vt,e.exports=s.default})(dt,dt.exports);var qe=dt.exports;const Je=ie(qe),Qe=e=>Nt.dispatch("text/setAttachmentList",e),kt=Nt.getters["text/findAttachment"];var J,H,j,Q,G,Y,Z,ut,X,pt,tt,mt,ot,Bt,et,vt;class Qs{constructor({session:s,user:i,shareToken:n,currentDirectory:r,fileId:a}){l(this,Z);l(this,X);l(this,tt);l(this,ot);l(this,et);l(this,J,void 0);l(this,H,void 0);l(this,j,void 0);l(this,Q,void 0);l(this,G,void 0);l(this,Y,void 0);c(this,J,s),c(this,H,i),c(this,j,n),c(this,Q,r),c(this,G,a!=null?a:s.documentId),c(this,Y,u(this,Z,ut).call(this))}async resolve(s,i=!0){let n;const r=/^\.attachments\.\d+\//;if(s.match(r)){const a=decodeURIComponent(s.replace(r,"").split("?")[0]);if(await o(this,Y),n=kt(a),i&&!n&&(await u(this,Z,ut).call(this),n=kt(a)),n)return n}return Ge(s)?{isImage:!0,name:u(this,X,pt).call(this,s),previewUrl:s,fullUrl:s}:{isImage:!0,name:u(this,X,pt).call(this,s),previewUrl:u(this,tt,mt).call(this,s),fullUrl:u(this,tt,mt).call(this,s)}}}J=new WeakMap,H=new WeakMap,j=new WeakMap,Q=new WeakMap,G=new WeakMap,Y=new WeakMap,Z=new WeakSet,ut=async function(){return Qe({documentId:o(this,G),session:o(this,J),shareToken:o(this,j)})},X=new WeakSet,pt=function(s){return s.split("/").pop()},tt=new WeakSet,mt=function(s){if(o(this,H)){const a=o(this,H).uid,_=u(this,et,vt).call(this,s).split("/").map(encodeURIComponent).join("/");return se("dav/files/".concat(a).concat(_))}const i=u(this,et,vt).call(this,s).split("/"),n=i.pop(),r=i.join("/");return It("/s/{token}/download?path={dirname}&files={basename}",{token:o(this,j),basename:n,dirname:r})},ot=new WeakSet,Bt=function(s){return decodeURI(s.split("?")[0])},et=new WeakSet,vt=function(s){const i=[o(this,Q),u(this,ot,Bt).call(this,s)].join("/");return Je(i)};function Ge(e){return e.startsWith("http://")||e.startsWith("https://")||e.startsWith("data:")}const Ye=rt({name:"NcActionButton",components:{NextcloudVueNcActionButton:bt,Help:Kt}});var Ze=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("NextcloudVueNcActionButton",e._g({attrs:{"close-after-click":"","data-text-action-entry":"formatting-help"},scopedSlots:e._u([{key:"icon",fn:function(){return[s("Help")]},proxy:!0}])},e.$listeners),[e._v(" "+e._s(e.t("text","Formatting help"))+" ")])},Xe=[],ts=x(Ye,Ze,Xe,!1,null,null,null,null);const es=ts.exports,ss=rt({name:"CharacterCount",components:{AlphabeticalVariant:qt,NcActionText:re},mixins:[at],props:{visible:Boolean},data:()=>({wordCount:0,charCount:0}),computed:{countString(){return"".concat(gt("text","%n word","%n words",this.wordCount),", ").concat(gt("text","%n char","%n chars",this.charCount))}},watch:{visible:"refresh"},created(){this.refresh()},methods:{refresh(){this.wordCount=this.$editor.storage.characterCount.words(),this.charCount=this.$editor.storage.characterCount.characters()}}});var is=function(){var e=this,s=e._self._c;return e._self._setupProxy,s("NcActionText",{attrs:{"data-text-action-entry":"character-count"},scopedSlots:e._u([{key:"icon",fn:function(){return[s("AlphabeticalVariant")]},proxy:!0},{key:"default",fn:function(){return[e._v(" "+e._s(e.countString)+" ")]},proxy:!0}])})},ns=[],os=x(ss,is,ns,!1,null,null,null,null);const rs=os.exports;function as(){var e;return((e=navigator==null?void 0:navigator.userAgentData)==null?void 0:e.mobile)!==void 0?navigator.userAgentData.mobile:[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/playbook/i,/silk/i,/BlackBerry/i,/Windows Phone/i].some(s=>navigator.userAgent.match(s))}const cs={name:"HelpModal",components:{NcDialog:ae},data(){return{formatted:{bold:!0,italic:!0,strikethrough:!0,heading1:!0,heading6:!0,unorderdList:!0,orderedList:!0,checkList:!0,blockQuote:!0,codeBlock:!0}}},computed:{isFormatted(){return e=>this.formatted[e]},isMobileCached(){return this.isMobilePlatform()}},methods:{toggleFormatted(e){this.formatted[e]=!this.formatted[e]},isMobilePlatform:as}};var ls=function(){var e=this,s=e._self._c;return s("NcDialog",{attrs:{size:"normal","data-text-el":"formatting-help",name:e.t("text","Formatting and shortcuts"),"close-on-click-outside":!0},on:{closing:function(i){return e.$emit("close")}}},[s("h2",[e._v(e._s(e.t("text","Formatting and shortcuts")))]),s("p",[e._v(e._s(e.t("text","Speed up your writing with simple shortcuts.")))]),e.isMobileCached?s("p",[e._v(" "+e._s(e.t("text","Just type the Markdown syntax from below."))+" ")]):s("p",[e._v(" "+e._s(e.t("text","Just type the Markdown syntax or use keyboard shortcuts from below."))+" ")]),s("table",[s("thead",[s("tr",[s("th",[e._v(e._s(e.t("text","Style")))]),s("th",[e._v(e._s(e.t("text","Syntax")))]),e.isMobileCached?e._e():s("th",[e._v(" "+e._s(e.t("text","Keyboard shortcuts"))+" ")])])]),s("tbody",[s("tr",[s("td",[e._v(e._s(e.t("text","New paragraph")))]),s("td",[s("kbd",[e._v(e._s(e.t("text","Enter")))])]),e.isMobileCached?e._e():s("td")]),s("tr",[s("td",[e._v(e._s(e.t("text","Hard line break")))]),s("td",[s("kbd",[e._v(e._s(e.t("text","Enter")))]),e._v(" "+e._s(e.t("text","followed by"))+" "),s("kbd",[e._v(e._s(e.t("text","Backspace")))])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),s("kbd",[e._v(e._s(e.t("text","Enter")))])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Bold")))]),s("td",[s("code",[e._v("**"+e._s(e.t("text","Bold text"))+"**")])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v("B")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Italic")))]),s("td",[s("code",[e._v("*"+e._s(e.t("text","Italicized text"))+"*")])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v("I")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Strikethrough")))]),s("td",[s("code",[e._v("~~"+e._s(e.t("text","Mistaken text"))+"~~")])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),s("kbd",[e._v("S")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Underline")))]),s("td",[s("code",[e._v("__"+e._s(e.t("text","Underlined text"))+"__")])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v("U")])])]),s("tr",[s("td",{staticClass:"ellipsis_top"},[e._v(" "+e._s(e.t("text","Heading 1"))+" ")]),s("td",{staticClass:"ellipsis_top"},[s("code",[e._v("# "+e._s(e.t("text","Heading level 1")))])]),e.isMobileCached?e._e():s("td",{staticClass:"ellipsis_top"},[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),s("kbd",[e._v("1")])])]),s("tr",[s("td",{staticClass:"noborder ellipsis"},[e._v(" … ")]),s("td",{staticClass:"noborder ellipsis"},[e._v(" … ")]),e.isMobileCached?e._e():s("td",{staticClass:"ellipsis noborder"},[e._v(" … ")])]),s("tr",[s("td",{staticClass:"noborder ellipsis_bottom"},[e._v(" "+e._s(e.t("text","Heading 6"))+" ")]),s("td",{staticClass:"noborder ellipsis_bottom"},[s("code",[e._v("###### "+e._s(e.t("text","Heading level 6")))])]),e.isMobileCached?e._e():s("td",{staticClass:"noborder ellipsis_bottom"},[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),s("kbd",[e._v("6")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Unordered list")))]),s("td",[s("code",[e._v("* "+e._s(e.t("text","An item")))])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),s("kbd",[e._v("8")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Ordered list")))]),s("td",[s("code",[e._v("1. "+e._s(e.t("text","First item")))])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v(e._s(e.t("text","Shift")))]),e._v(" + "),s("kbd",[e._v("7")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Checklist")))]),s("td",[s("code",[e._v("* [] "+e._s(e.t("text","To-Do item")))])]),e.isMobileCached?e._e():s("td")]),s("tr",[s("td",[e._v(e._s(e.t("text","Blockquote")))]),s("td",[s("code",[e._v("> "+e._s(e.t("text","Quoted text")))])]),e.isMobileCached?e._e():s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v(">")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Code block")))]),s("td",[s("code",[e._v("``` "+e._s(e.t("text","Some code")))])]),e.isMobileCached?e._e():s("td")]),s("tr",[s("td",[e._v(e._s(e.t("text","Insert emoji")))]),s("td",[s("code",[e._v(":"+e._s(e.t("text","emoji")))])]),e.isMobileCached?e._e():s("td")]),s("tr",[s("td",[e._v(e._s(e.t("text","Mention someone")))]),s("td",[s("code",[e._v("@"+e._s(e.t("text","name")))])]),e.isMobileCached?e._e():s("td")]),s("tr",[s("td",[e._v(e._s(e.t("text","Smart picker")))]),s("td",[s("code",[e._v("/"+e._s(e.t("text","something")))])]),e.isMobileCached?e._e():s("td")])])]),s("table",{attrs:{vif:"!isMobileCached"}},[s("thead",[s("tr",[s("th",[e._v(e._s(e.t("text","Action")))]),s("th",[e._v(e._s(e.t("text","Keyboard shortcuts")))])])]),s("tbody",[s("tr",[s("td",[e._v(e._s(e.t("text","Undo")))]),s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v("Z")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Redo")))]),s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v("Y")])])]),s("tr",[s("td",[e._v(e._s(e.t("text","Toggle outline")))]),s("td",[s("kbd",[e._v(e._s(e.t("text","Ctrl")))]),e._v(" + "),s("kbd",[e._v(e._s(e.t("text","Alt")))]),e._v(" + "),s("kbd",[e._v("H")])])])])])])},hs=[],ds=x(cs,ls,hs,!1,null,"a12b069a",null,null);const us=ds.exports,ps={name:"MenuBar",components:{ActionFormattingHelp:es,ActionList:Rt,ActionSingle:Pt,HelpModal:us,NcActionSeparator:Ct,NcActionButton:bt,CharacterCount:rs,TranslateVariant:Jt},extends:Dt,mixins:[at,ue,Mt,Tt],provide(){const e={};return Object.defineProperties(e,{[Yt]:{get:()=>this.randomID}}),e},props:{isHidden:{type:Boolean,default:!1}},data(){return{entries:[...Qt],randomID:"menu-bar-".concat(Math.ceil(Math.random()*1e4+500).toString(16)),displayHelp:!1,isReady:!1,canTranslate:de("text","translation_languages",[]).length>0,resize:null,iconsLimit:4}},computed:{visibleEntries(){return this.entries.filter(({priority:e})=>e===void 0||e<=this.iconsLimit)},hiddenEntries(){const e=this.entries.filter(({priority:i})=>i!==void 0&&i>this.iconsLimit),s=e.reduce((i,n,r)=>{var _;const a=(_=n.children)!=null?_:[n];if(a.length>1){const k=i.length&&!i.at(-1).isSeparator?[{key:"separator-before-".concat(n.id),isSeparator:!0}]:[],R=r!==e.length-1?[{key:"separator-after-".concat(n.id),isSeparator:!0}]:[];return[...i,...k,...a,...R]}return[...i,...a]},[]);return{key:"remain",label:this.t("text","Remaining actions"),icon:Gt,children:s}}},mounted(){this.resize=he(this.$refs.menubar,this.onResize),this.$nextTick(()=>{this.isReady=!0,this.$emit("update:loaded",!0)})},beforeDestroy(){var e;(e=this.resize)==null||e.stop()},methods:{onResize(e){window.requestAnimationFrame(()=>{const s=e[0],{width:i}=s.contentRect,n=i-4,r=this.$isMobile?44:46,a=Math.floor(n/r);this.iconsLimit=a-1})},showHelp(){this.displayHelp=!0},hideHelp(){this.displayHelp=!1},showTranslate(){const{from:e,to:s}=this.$editor.view.state.selection;let i=this.$editor.view.state.doc.textBetween(e,s," ");i.trim().length||(this.$editor.commands.selectAll(),i=this.$editor.view.state.doc.textContent),console.debug("translation click",this.$editor.view.state.selection,i),Ot("text:translate-modal:show",{content:i})}}};var ms=function(){var e=this,s=e._self._c;return s("div",{staticClass:"text-menubar",class:{"text-menubar--ready":e.isReady,"text-menubar--hide":e.isHidden,"text-menubar--is-workspace":e.$isRichWorkspace},attrs:{id:e.randomID,"data-text-el":"menubar",role:"region","aria-label":e.t("text","Editor actions")}},[e.displayHelp?s("HelpModal",{on:{close:e.hideHelp}}):e._e(),e.$isRichEditor?s("div",{ref:"menubar",staticClass:"text-menubar__entries",attrs:{role:"toolbar","aria-label":e.t("text","Formatting menu bar")},on:{keydown:[function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"left",37,i.key,["Left","ArrowLeft"])||"button"in i&&i.button!==0?null:(i.stopPropagation(),e.handleToolbarNavigation.apply(null,arguments))},function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"right",39,i.key,["Right","ArrowRight"])||"button"in i&&i.button!==2?null:(i.stopPropagation(),e.handleToolbarNavigation.apply(null,arguments))}]}},[e._l(e.visibleEntries,function(i,n){return s(i.component?i.component:i.children?"ActionList":"ActionSingle",{key:i.key,ref:"menuEntries",refInFor:!0,tag:"component",attrs:{"action-entry":i,"can-be-focussed":e.activeMenuEntry===n},on:{disabled:function(r){return e.disableMenuEntry(i.key,r)},click:function(r){e.activeMenuEntry=n}}})}),s("ActionList",{ref:"remainingEntries",attrs:{"action-entry":e.hiddenEntries,"can-be-focussed":e.activeMenuEntry===e.visibleEntries.length,"force-enabled":!0},on:{click:function(i){e.activeMenuEntry="remain"}},scopedSlots:e._u([{key:"lastAction",fn:function({visible:i}){return[e.canTranslate?s("NcActionButton",{attrs:{"close-after-click":""},on:{click:e.showTranslate},scopedSlots:e._u([{key:"icon",fn:function(){return[s("TranslateVariant")]},proxy:!0}],null,!0)},[e._v(" "+e._s(e.t("text","Translate"))+" ")]):e._e(),s("ActionFormattingHelp",{on:{click:e.showHelp}}),s("NcActionSeparator"),s("CharacterCount",e._b({},"CharacterCount",{visible:i},!1))]}}],null,!1,2316723924)})],2):e._e(),s("div",{staticClass:"text-menubar__slot"},[e._t("default")],2)],1)},vs=[],_s=x(ps,ms,vs,!1,null,"de8622e2",null,null);const Gs=_s.exports,fs={name:"ContentContainer",components:{EditorContent:Zt,EditorOutline:Xt},mixins:[at,wt],computed:{showOutline(){return this.$outlineState.visible}}};var bs=function(){var e=this,s=e._self._c;return s("div",{staticClass:"content-wrapper text-editor__content-wrapper",class:{"--show-outline":e.showOutline},attrs:{"data-text-el":"editor-content-wrapper"}},[e.showOutline?s("div",{staticClass:"text-editor__content-wrapper__left"},[s("EditorOutline")],1):e._e(),e._t("default"),s("EditorContent",{staticClass:"editor__content text-editor__content",attrs:{role:"document",editor:e.$editor}}),s("div",{staticClass:"text-editor__content-wrapper__right"})],2)},ys=[],gs=x(fs,bs,ys,!1,null,"ca5f5c35",null,null);const Ys=gs.exports,Et=e=>e.split("/").slice(0,-1).join("/"),xs={name:"MediaHandler",mixins:[at,pe,me],provide(){const e={};return Object.defineProperties(e,{[ve]:{get:()=>this.showAttachmentPrompt},[_e]:{get:()=>this.chooseLocalFile},[fe]:{get:()=>this.state}}),e},data(){return{lastFilePath:null,draggedOver:!1,state:{isUploadingAttachments:!1}}},computed:{initialFilePath(){var e,s,i;return(i=this.lastFilePath)!=null?i:Et((s=(e=this.$file)==null?void 0:e.relativePath)!=null?s:"/")}},methods:{setDraggedOver(e){this.draggedOver=e},onPaste(e){this.uploadAttachmentFiles(e.detail.files)},onEditorDrop(e){this.uploadAttachmentFiles(e.detail.files,e.detail.position),this.draggedOver=!1},onAttachmentUploadFilePicked(e){this.uploadAttachmentFiles(e.target.files),e.target.value=""},chooseLocalFile(){this.$refs.attachmentFileInput.click()},async uploadAttachmentFiles(e,s=null){if(!e)return;this.state.isUploadingAttachments=!0;const i=[...e].map(n=>this.uploadAttachmentFile(n,s));return Promise.all(i).catch(n=>{var r,a;v.error("Uploading multiple images failed",{error:n}),ht(((a=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:a.error)||n.message)}).then(()=>{this.state.isUploadingAttachments=!1})},async uploadAttachmentFile(e,s=null){return this.state.isUploadingAttachments=!0,this.$syncService.uploadAttachment(e).then(i=>{var n,r,a;this.insertAttachment((n=i.data)==null?void 0:n.name,(r=i.data)==null?void 0:r.id,e.type,s,(a=i.data)==null?void 0:a.dirname)}).catch(i=>{var n,r;v.error("Uploading image failed",{error:i}),ht((r=(n=i==null?void 0:i.response)==null?void 0:n.data)==null?void 0:r.error)}).then(()=>{this.state.isUploadingAttachments=!1})},showAttachmentPrompt(){ne()&&OC.dialogs.filepicker(t("text","Insert an attachment"),e=>{this.insertFromPath(e)},!1,[],!0,void 0,this.initialFilePath)},insertFromPath(e){return this.lastFilePath=Et(e),this.state.isUploadingAttachments=!0,this.$syncService.insertAttachmentFile(e).then(s=>{var i,n,r,a;this.insertAttachment((i=s.data)==null?void 0:i.name,(n=s.data)==null?void 0:n.id,(r=s.data)==null?void 0:r.mimetype,null,(a=s.data)==null?void 0:a.dirname)}).catch(s=>{var i,n;v.error("Failed to insert image path",{error:s}),ht(((n=(i=s==null?void 0:s.response)==null?void 0:i.data)==null?void 0:n.error)||s.message)}).then(()=>{this.state.isUploadingAttachments=!1})},insertAttachment(e,s,i,n=null,r=""){const a=r+"/"+encodeURIComponent(e).replace(/[!'()*]/g,R=>"%"+R.charCodeAt(0).toString(16).toUpperCase()),_=e.replaceAll(/[[\]]/g,"");(n?this.$editor.chain().focus(n):this.$editor.chain()).setImage({src:a,alt:_}).run();const k=this.$editor.view.state.selection;k.empty||this.$editor.commands.focus(k.to),this.$editor.commands.scrollIntoView(),Ot("text:image-node:add",null)}}};var ks=function(){var e=this,s=e._self._c;return s("div",{staticClass:"editor editor-media-handler",class:{draggedOver:e.draggedOver},attrs:{"data-text-el":"editor-media-handler"},on:{"image-paste":e.onPaste,dragover:function(i){return i.preventDefault(),i.stopPropagation(),e.setDraggedOver(!0)},dragleave:function(i){return i.preventDefault(),i.stopPropagation(),e.setDraggedOver(!1)},"file-drop":e.onEditorDrop}},[s("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"attachmentFileInput",attrs:{"data-text-el":"attachment-file-input",type:"file",accept:"*/*",multiple:""},on:{change:e.onAttachmentUploadFilePicked}}),e._t("default")],2)},Es=[],Cs=x(xs,ks,Es,!1,null,null,null,null);const As=Cs.exports,ws={name:"MainContainer",components:{MediaHandler:As},mixins:[be]};var Ss=function(){var e=this,s=e._self._c;return s("div",{staticClass:"editor"},[e.$editorUpload?s("MediaHandler",{staticClass:"text-editor__main"},[e._t("default")],2):e._t("default")],2)},Is=[],Os=x(ws,Ss,Is,!1,null,"a2152987",null,null);const Zs=Os.exports,$s={name:"Wrapper",mixins:[At,Mt,Tt],provide(){const e={};return Object.defineProperties(e,{[te]:{get:()=>this.outline},[ee]:{get:()=>({toggle:this.outlineToggle})}}),e},props:{syncError:{type:Object,default:null},hasConnectionIssue:{type:Boolean,default:!1},contentLoaded:{type:Boolean,default:!0},showAuthorAnnotations:{type:Boolean,default:!1},showOutlineOutside:{type:Boolean,default:!1}},data:()=>({outline:{visible:!1,enable:!1}}),computed:{...oe({viewWidth:e=>e.text.viewWidth}),hasSyncCollission(){return this.syncError&&this.syncError.type===y.SAVE_COLLISSION},showOutline(){return this.isAbleToShowOutline?this.outline.visible:!1},isAbleToShowOutline(){return this.$isRichWorkspace?!1:this.viewWidth>1265}},watch:{showOutlineOutside(){this.outline.visible=this.showOutlineOutside}},mounted(){this.outline.enable=this.isAbleToShowOutline,this.$watch(()=>this.isAbleToShowOutline,e=>{Object.assign(this.outline,{enable:e})}),document.addEventListener("keydown",this.handleKeyDown)},beforeDestroy(){document.removeEventListener("keydown",this.handleKeyDown)},methods:{outlineToggle(){this.outline.visible=!this.outline.visible,this.$emit("outline-toggled",this.outline.visible)},handleKeyDown(e){e.ctrlKey&&e.altKey&&e.key==="h"&&this.outlineToggle()}}};var Ns=function(){var e=this,s=e._self._c;return s("div",{staticClass:"text-editor__wrapper",class:{"has-conflicts":e.hasSyncCollission,"is-rich-workspace":e.$isRichWorkspace,"is-rich-editor":e.$isRichEditor,"show-color-annotations":e.showAuthorAnnotations}},[e._t("default")],2)},Ms=[],Ts=x($s,Ns,Ms,!1,null,"b5ac258f",null,null);const Xs=Ts.exports;export{Qs as A,Ys as C,y as E,We as I,Zs as M,Ks as R,Js as S,Xs as W,Gs as a,Ke as b,qs as c};
