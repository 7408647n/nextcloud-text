/*! third party licenses: js/vendor.LICENSE.txt */
import{_ as h,j as T,l as u,d as B,ad as H,ae as it,ac as pt,u as A,af as gt,a0 as xt,a6 as ft,ag as ut,ah as q,i as Q}from"./mermaid.core-DqdNzqxr.chunk.mjs";var wt=h((a,t,r,s)=>{t.forEach(l=>{Ct[l](a,r,s)})},"insertMarkers"),bt=h((a,t,r)=>{u.trace("Making markers for ",r),a.append("defs").append("marker").attr("id",r+"_"+t+"-extensionStart").attr("class","marker extension "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),a.append("defs").append("marker").attr("id",r+"_"+t+"-extensionEnd").attr("class","marker extension "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},"extension"),mt=h((a,t,r)=>{a.append("defs").append("marker").attr("id",r+"_"+t+"-compositionStart").attr("class","marker composition "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),a.append("defs").append("marker").attr("id",r+"_"+t+"-compositionEnd").attr("class","marker composition "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"composition"),kt=h((a,t,r)=>{a.append("defs").append("marker").attr("id",r+"_"+t+"-aggregationStart").attr("class","marker aggregation "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),a.append("defs").append("marker").attr("id",r+"_"+t+"-aggregationEnd").attr("class","marker aggregation "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"aggregation"),Lt=h((a,t,r)=>{a.append("defs").append("marker").attr("id",r+"_"+t+"-dependencyStart").attr("class","marker dependency "+t).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),a.append("defs").append("marker").attr("id",r+"_"+t+"-dependencyEnd").attr("class","marker dependency "+t).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},"dependency"),vt=h((a,t,r)=>{a.append("defs").append("marker").attr("id",r+"_"+t+"-lollipopStart").attr("class","marker lollipop "+t).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),a.append("defs").append("marker").attr("id",r+"_"+t+"-lollipopEnd").attr("class","marker lollipop "+t).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},"lollipop"),St=h((a,t,r)=>{a.append("marker").attr("id",r+"_"+t+"-pointEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",6).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",12).attr("markerHeight",12).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),a.append("marker").attr("id",r+"_"+t+"-pointStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",12).attr("markerHeight",12).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"point"),Bt=h((a,t,r)=>{a.append("marker").attr("id",r+"_"+t+"-circleEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),a.append("marker").attr("id",r+"_"+t+"-circleStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"circle"),Mt=h((a,t,r)=>{a.append("marker").attr("id",r+"_"+t+"-crossEnd").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),a.append("marker").attr("id",r+"_"+t+"-crossStart").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},"cross"),_t=h((a,t,r)=>{a.append("defs").append("marker").attr("id",r+"_"+t+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","strokeWidth").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"barb"),Ct={extension:bt,composition:mt,aggregation:kt,dependency:Lt,lollipop:vt,point:St,circle:Bt,cross:Mt,barb:_t},ye=wt;function V(a,t){t&&a.attr("style",t)}h(V,"applyStyle");function nt(a){const t=T(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),r=t.append("xhtml:div"),s=a.label,l=a.isNode?"nodeLabel":"edgeLabel",e=r.append("span");return e.html(s),V(e,a.labelStyle),e.attr("class",l),V(r,a.labelStyle),r.style("display","inline-block"),r.style("white-space","nowrap"),r.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()}h(nt,"addHtmlLabel");var Tt=h((a,t,r,s)=>{let l=a||"";if(typeof l=="object"&&(l=l[0]),H(B().flowchart.htmlLabels)){l=l.replace(/\\n|\n/g,"<br />"),u.debug("vertexText"+l);const e={isNode:s,label:ut(q(l)),labelStyle:t.replace("fill:","color:")};return nt(e)}else{const e=document.createElementNS("http://www.w3.org/2000/svg","text");e.setAttribute("style",t.replace("color:","fill:"));let i=[];typeof l=="string"?i=l.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(l)?i=l:i=[];for(const n of i){const d=document.createElementNS("http://www.w3.org/2000/svg","tspan");d.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),d.setAttribute("dy","1em"),d.setAttribute("x","0"),r?d.setAttribute("class","title-row"):d.setAttribute("class","row"),d.textContent=n.trim(),e.appendChild(d)}return e}},"createLabel"),R=Tt,M=h(async(a,t,r,s)=>{const l=B();let e;const i=t.useHtmlLabels||H(l.flowchart.htmlLabels);r?e=r:e="node default";const n=a.insert("g").attr("class",e).attr("id",t.domId||t.id),d=n.insert("g").attr("class","label").attr("style",t.labelStyle);let c;t.labelText===void 0?c="":c=typeof t.labelText=="string"?t.labelText:t.labelText[0];const o=d.node();let y;t.labelType==="markdown"?y=it(d,Q(q(c),l),{useHtmlLabels:i,width:t.width||l.flowchart.wrappingWidth,classes:"markdown-node-label"},l):y=o.appendChild(R(Q(q(c),l),t.labelStyle,!1,s));let p=y.getBBox();const g=t.padding/2;if(H(l.flowchart.htmlLabels)){const f=y.children[0],k=T(y),x=f.getElementsByTagName("img");if(x){const _=c.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...x].map(w=>new Promise(E=>{function S(){if(w.style.display="flex",w.style.flexDirection="column",_){const D=l.fontSize?l.fontSize:window.getComputedStyle(document.body).fontSize,X=parseInt(D,10)*5+"px";w.style.minWidth=X,w.style.maxWidth=X}else w.style.width="100%";E(w)}h(S,"setupImage"),setTimeout(()=>{w.complete&&S()}),w.addEventListener("error",S),w.addEventListener("load",S)})))}p=f.getBoundingClientRect(),k.attr("width",p.width),k.attr("height",p.height)}return i?d.attr("transform","translate("+-p.width/2+", "+-p.height/2+")"):d.attr("transform","translate(0, "+-p.height/2+")"),t.centerLabel&&d.attr("transform","translate("+-p.width/2+", "+-p.height/2+")"),d.insert("rect",":first-child"),{shapeSvg:n,bbox:p,halfPadding:g,label:d}},"labelHelper"),m=h((a,t)=>{const r=t.node().getBBox();a.width=r.width,a.height=r.height},"updateNodeBounds");function W(a,t,r,s){return a.insert("polygon",":first-child").attr("points",s.map(function(l){return l.x+","+l.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+r/2+")")}h(W,"insertPolygonShape");var Et=h(a=>{const t=new Set;for(const r of a)switch(r){case"x":t.add("right"),t.add("left");break;case"y":t.add("up"),t.add("down");break;default:t.add(r);break}return t},"expandAndDeduplicateDirections"),$t=h((a,t,r)=>{const s=Et(a),l=2,e=t.height+2*r.padding,i=e/l,n=t.width+2*i+r.padding,d=r.padding/2;return s.has("right")&&s.has("left")&&s.has("up")&&s.has("down")?[{x:0,y:0},{x:i,y:0},{x:n/2,y:2*d},{x:n-i,y:0},{x:n,y:0},{x:n,y:-e/3},{x:n+2*d,y:-e/2},{x:n,y:-2*e/3},{x:n,y:-e},{x:n-i,y:-e},{x:n/2,y:-e-2*d},{x:i,y:-e},{x:0,y:-e},{x:0,y:-2*e/3},{x:-2*d,y:-e/2},{x:0,y:-e/3}]:s.has("right")&&s.has("left")&&s.has("up")?[{x:i,y:0},{x:n-i,y:0},{x:n,y:-e/2},{x:n-i,y:-e},{x:i,y:-e},{x:0,y:-e/2}]:s.has("right")&&s.has("left")&&s.has("down")?[{x:0,y:0},{x:i,y:-e},{x:n-i,y:-e},{x:n,y:0}]:s.has("right")&&s.has("up")&&s.has("down")?[{x:0,y:0},{x:n,y:-i},{x:n,y:-e+i},{x:0,y:-e}]:s.has("left")&&s.has("up")&&s.has("down")?[{x:n,y:0},{x:0,y:-i},{x:0,y:-e+i},{x:n,y:-e}]:s.has("right")&&s.has("left")?[{x:i,y:0},{x:i,y:-d},{x:n-i,y:-d},{x:n-i,y:0},{x:n,y:-e/2},{x:n-i,y:-e},{x:n-i,y:-e+d},{x:i,y:-e+d},{x:i,y:-e},{x:0,y:-e/2}]:s.has("up")&&s.has("down")?[{x:n/2,y:0},{x:0,y:-d},{x:i,y:-d},{x:i,y:-e+d},{x:0,y:-e+d},{x:n/2,y:-e},{x:n,y:-e+d},{x:n-i,y:-e+d},{x:n-i,y:-d},{x:n,y:-d}]:s.has("right")&&s.has("up")?[{x:0,y:0},{x:n,y:-i},{x:0,y:-e}]:s.has("right")&&s.has("down")?[{x:0,y:0},{x:n,y:0},{x:0,y:-e}]:s.has("left")&&s.has("up")?[{x:n,y:0},{x:0,y:-i},{x:n,y:-e}]:s.has("left")&&s.has("down")?[{x:n,y:0},{x:0,y:0},{x:n,y:-e}]:s.has("right")?[{x:i,y:-d},{x:i,y:-d},{x:n-i,y:-d},{x:n-i,y:0},{x:n,y:-e/2},{x:n-i,y:-e},{x:n-i,y:-e+d},{x:i,y:-e+d},{x:i,y:-e+d}]:s.has("left")?[{x:i,y:0},{x:i,y:-d},{x:n-i,y:-d},{x:n-i,y:-e+d},{x:i,y:-e+d},{x:i,y:-e},{x:0,y:-e/2}]:s.has("up")?[{x:i,y:-d},{x:i,y:-e+d},{x:0,y:-e+d},{x:n/2,y:-e},{x:n,y:-e+d},{x:n-i,y:-e+d},{x:n-i,y:-d}]:s.has("down")?[{x:n/2,y:0},{x:0,y:-d},{x:i,y:-d},{x:i,y:-e+d},{x:n-i,y:-e+d},{x:n-i,y:-d},{x:n,y:-d}]:[{x:0,y:0}]},"getArrowPoints");function st(a,t){return a.intersect(t)}h(st,"intersectNode");var Pt=st;function lt(a,t,r,s){var l=a.x,e=a.y,i=l-s.x,n=e-s.y,d=Math.sqrt(t*t*n*n+r*r*i*i),c=Math.abs(t*r*i/d);s.x<l&&(c=-c);var o=Math.abs(t*r*n/d);return s.y<e&&(o=-o),{x:l+c,y:e+o}}h(lt,"intersectEllipse");var dt=lt;function ot(a,t,r){return dt(a,t,t,r)}h(ot,"intersectCircle");var Nt=ot;function ct(a,t,r,s){var l,e,i,n,d,c,o,y,p,g,f,k,x,_,w;if(l=t.y-a.y,i=a.x-t.x,d=t.x*a.y-a.x*t.y,p=l*r.x+i*r.y+d,g=l*s.x+i*s.y+d,!(p!==0&&g!==0&&F(p,g))&&(e=s.y-r.y,n=r.x-s.x,c=s.x*r.y-r.x*s.y,o=e*a.x+n*a.y+c,y=e*t.x+n*t.y+c,!(o!==0&&y!==0&&F(o,y))&&(f=l*n-e*i,f!==0)))return k=Math.abs(f/2),x=i*c-n*d,_=x<0?(x-k)/f:(x+k)/f,x=e*d-l*c,w=x<0?(x-k)/f:(x+k)/f,{x:_,y:w}}h(ct,"intersectLine");function F(a,t){return a*t>0}h(F,"sameSign");var Rt=ct,Wt=ht;function ht(a,t,r){var s=a.x,l=a.y,e=[],i=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(f){i=Math.min(i,f.x),n=Math.min(n,f.y)}):(i=Math.min(i,t.x),n=Math.min(n,t.y));for(var d=s-a.width/2-i,c=l-a.height/2-n,o=0;o<t.length;o++){var y=t[o],p=t[o<t.length-1?o+1:0],g=Rt(a,r,{x:d+y.x,y:c+y.y},{x:d+p.x,y:c+p.y});g&&e.push(g)}return e.length?(e.length>1&&e.sort(function(f,k){var x=f.x-r.x,_=f.y-r.y,w=Math.sqrt(x*x+_*_),E=k.x-r.x,S=k.y-r.y,D=Math.sqrt(E*E+S*S);return w<D?-1:w===D?0:1}),e[0]):a}h(ht,"intersectPolygon");var Ht=h((a,t)=>{var r=a.x,s=a.y,l=t.x-r,e=t.y-s,i=a.width/2,n=a.height/2,d,c;return Math.abs(e)*i>Math.abs(l)*n?(e<0&&(n=-n),d=e===0?0:n*l/e,c=n):(l<0&&(i=-i),d=i,c=l===0?0:i*e/l),{x:r+d,y:s+c}},"intersectRect"),It=Ht,b={node:Pt,circle:Nt,ellipse:dt,polygon:Wt,rect:It},Dt=h(async(a,t)=>{t.useHtmlLabels||B().flowchart.htmlLabels||(t.centerLabel=!0);const{shapeSvg:r,bbox:s,halfPadding:l}=await M(a,t,"node "+t.classes,!0);u.info("Classes = ",t.classes);const e=r.insert("rect",":first-child");return e.attr("rx",t.rx).attr("ry",t.ry).attr("x",-s.width/2-l).attr("y",-s.height/2-l).attr("width",s.width+t.padding).attr("height",s.height+t.padding),m(t,e),t.intersect=function(i){return b.rect(t,i)},r},"note"),Yt=Dt,G=h(a=>a?" "+a:"","formatClass"),N=h((a,t)=>"".concat(t||"node default").concat(G(a.classes)," ").concat(G(a.class)),"getClassesFromNode"),K=h(async(a,t)=>{const{shapeSvg:r,bbox:s}=await M(a,t,N(t,void 0),!0),l=s.width+t.padding,e=s.height+t.padding,i=l+e,n=[{x:i/2,y:0},{x:i,y:-i/2},{x:i/2,y:-i},{x:0,y:-i/2}];u.info("Question main (Circle)");const d=W(r,i,i,n);return d.attr("style",t.style),m(t,d),t.intersect=function(c){return u.warn("Intersect called"),b.polygon(t,n,c)},r},"question"),Xt=h((a,t)=>{const r=a.insert("g").attr("class","node default").attr("id",t.domId||t.id),s=28,l=[{x:0,y:s/2},{x:s/2,y:0},{x:0,y:-s/2},{x:-s/2,y:0}];return r.insert("polygon",":first-child").attr("points",l.map(function(e){return e.x+","+e.y}).join(" ")).attr("class","state-start").attr("r",7).attr("width",28).attr("height",28),t.width=28,t.height=28,t.intersect=function(e){return b.circle(t,14,e)},r},"choice"),Ut=h(async(a,t)=>{const{shapeSvg:r,bbox:s}=await M(a,t,N(t,void 0),!0),l=4,e=s.height+t.padding,i=e/l,n=s.width+2*i+t.padding,d=[{x:i,y:0},{x:n-i,y:0},{x:n,y:-e/2},{x:n-i,y:-e},{x:i,y:-e},{x:0,y:-e/2}],c=W(r,n,e,d);return c.attr("style",t.style),m(t,c),t.intersect=function(o){return b.polygon(t,d,o)},r},"hexagon"),At=h(async(a,t)=>{const{shapeSvg:r,bbox:s}=await M(a,t,void 0,!0),l=2,e=s.height+2*t.padding,i=e/l,n=s.width+2*i+t.padding,d=$t(t.directions,s,t),c=W(r,n,e,d);return c.attr("style",t.style),m(t,c),t.intersect=function(o){return b.polygon(t,d,o)},r},"block_arrow"),jt=h(async(a,t)=>{const{shapeSvg:r,bbox:s}=await M(a,t,N(t,void 0),!0),l=s.width+t.padding,e=s.height+t.padding,i=[{x:-e/2,y:0},{x:l,y:0},{x:l,y:-e},{x:-e/2,y:-e},{x:0,y:-e/2}];return W(r,l,e,i).attr("style",t.style),t.width=l+e,t.height=e,t.intersect=function(n){return b.polygon(t,i,n)},r},"rect_left_inv_arrow"),Ot=h(async(a,t)=>{const{shapeSvg:r,bbox:s}=await M(a,t,N(t),!0),l=s.width+t.padding,e=s.height+t.padding,i=[{x:-2*e/6,y:0},{x:l-e/6,y:0},{x:l+2*e/6,y:-e},{x:e/6,y:-e}],n=W(r,l,e,i);return n.attr("style",t.style),m(t,n),t.intersect=function(d){return b.polygon(t,i,d)},r},"lean_right"),zt=h(async(a,t)=>{const{shapeSvg:r,bbox:s}=await M(a,t,N(t,void 0),!0),l=s.width+t.padding,e=s.height+t.padding,i=[{x:2*e/6,y:0},{x:l+e/6,y:0},{x:l-2*e/6,y:-e},{x:-e/6,y:-e}],n=W(r,l,e,i);return n.attr("style",t.style),m(t,n),t.intersect=function(d){return b.polygon(t,i,d)},r},"lean_left"),Zt=h(async(a,t)=>{const{shapeSvg:r,bbox:s}=await M(a,t,N(t,void 0),!0),l=s.width+t.padding,e=s.height+t.padding,i=[{x:-2*e/6,y:0},{x:l+2*e/6,y:0},{x:l-e/6,y:-e},{x:e/6,y:-e}],n=W(r,l,e,i);return n.attr("style",t.style),m(t,n),t.intersect=function(d){return b.polygon(t,i,d)},r},"trapezoid"),qt=h(async(a,t)=>{const{shapeSvg:r,bbox:s}=await M(a,t,N(t,void 0),!0),l=s.width+t.padding,e=s.height+t.padding,i=[{x:e/6,y:0},{x:l-e/6,y:0},{x:l+2*e/6,y:-e},{x:-2*e/6,y:-e}],n=W(r,l,e,i);return n.attr("style",t.style),m(t,n),t.intersect=function(d){return b.polygon(t,i,d)},r},"inv_trapezoid"),Vt=h(async(a,t)=>{const{shapeSvg:r,bbox:s}=await M(a,t,N(t,void 0),!0),l=s.width+t.padding,e=s.height+t.padding,i=[{x:0,y:0},{x:l+e/2,y:0},{x:l,y:-e/2},{x:l+e/2,y:-e},{x:0,y:-e}],n=W(r,l,e,i);return n.attr("style",t.style),m(t,n),t.intersect=function(d){return b.polygon(t,i,d)},r},"rect_right_inv_arrow"),Ft=h(async(a,t)=>{const{shapeSvg:r,bbox:s}=await M(a,t,N(t,void 0),!0),l=s.width+t.padding,e=l/2,i=e/(2.5+l/50),n=s.height+i+t.padding,d="M 0,"+i+" a "+e+","+i+" 0,0,0 "+l+" 0 a "+e+","+i+" 0,0,0 "+-l+" 0 l 0,"+n+" a "+e+","+i+" 0,0,0 "+l+" 0 l 0,"+-n,c=r.attr("label-offset-y",i).insert("path",":first-child").attr("style",t.style).attr("d",d).attr("transform","translate("+-l/2+","+-(n/2+i)+")");return m(t,c),t.intersect=function(o){const y=b.rect(t,o),p=y.x-t.x;if(e!=0&&(Math.abs(p)<t.width/2||Math.abs(p)==t.width/2&&Math.abs(y.y-t.y)>t.height/2-i)){let g=i*i*(1-p*p/(e*e));g!=0&&(g=Math.sqrt(g)),g=i-g,o.y-t.y>0&&(g=-g),y.y+=g}return y},r},"cylinder"),Jt=h(async(a,t)=>{const{shapeSvg:r,bbox:s,halfPadding:l}=await M(a,t,"node "+t.classes+" "+t.class,!0),e=r.insert("rect",":first-child"),i=t.positioned?t.width:s.width+t.padding,n=t.positioned?t.height:s.height+t.padding,d=t.positioned?-i/2:-s.width/2-l,c=t.positioned?-n/2:-s.height/2-l;if(e.attr("class","basic label-container").attr("style",t.style).attr("rx",t.rx).attr("ry",t.ry).attr("x",d).attr("y",c).attr("width",i).attr("height",n),t.props){const o=new Set(Object.keys(t.props));t.props.borders&&(z(e,t.props.borders,i,n),o.delete("borders")),o.forEach(y=>{u.warn("Unknown node property ".concat(y))})}return m(t,e),t.intersect=function(o){return b.rect(t,o)},r},"rect"),Qt=h(async(a,t)=>{const{shapeSvg:r,bbox:s,halfPadding:l}=await M(a,t,"node "+t.classes,!0),e=r.insert("rect",":first-child"),i=t.positioned?t.width:s.width+t.padding,n=t.positioned?t.height:s.height+t.padding,d=t.positioned?-i/2:-s.width/2-l,c=t.positioned?-n/2:-s.height/2-l;if(e.attr("class","basic cluster composite label-container").attr("style",t.style).attr("rx",t.rx).attr("ry",t.ry).attr("x",d).attr("y",c).attr("width",i).attr("height",n),t.props){const o=new Set(Object.keys(t.props));t.props.borders&&(z(e,t.props.borders,i,n),o.delete("borders")),o.forEach(y=>{u.warn("Unknown node property ".concat(y))})}return m(t,e),t.intersect=function(o){return b.rect(t,o)},r},"composite"),Gt=h(async(a,t)=>{const{shapeSvg:r}=await M(a,t,"label",!0);u.trace("Classes = ",t.class);const s=r.insert("rect",":first-child"),l=0,e=0;if(s.attr("width",l).attr("height",e),r.attr("class","label edgeLabel"),t.props){const i=new Set(Object.keys(t.props));t.props.borders&&(z(s,t.props.borders,l,e),i.delete("borders")),i.forEach(n=>{u.warn("Unknown node property ".concat(n))})}return m(t,s),t.intersect=function(i){return b.rect(t,i)},r},"labelRect");function z(a,t,r,s){const l=[],e=h(n=>{l.push(n,0)},"addBorder"),i=h(n=>{l.push(0,n)},"skipBorder");t.includes("t")?(u.debug("add top border"),e(r)):i(r),t.includes("r")?(u.debug("add right border"),e(s)):i(s),t.includes("b")?(u.debug("add bottom border"),e(r)):i(r),t.includes("l")?(u.debug("add left border"),e(s)):i(s),a.attr("stroke-dasharray",l.join(" "))}h(z,"applyNodePropertyBorders");var Kt=h((a,t)=>{let r;t.classes?r="node "+t.classes:r="node default";const s=a.insert("g").attr("class",r).attr("id",t.domId||t.id),l=s.insert("rect",":first-child"),e=s.insert("line"),i=s.insert("g").attr("class","label"),n=t.labelText.flat?t.labelText.flat():t.labelText;let d="";typeof n=="object"?d=n[0]:d=n,u.info("Label text abc79",d,n,typeof n=="object");const c=i.node().appendChild(R(d,t.labelStyle,!0,!0));let o={width:0,height:0};if(H(B().flowchart.htmlLabels)){const k=c.children[0],x=T(c);o=k.getBoundingClientRect(),x.attr("width",o.width),x.attr("height",o.height)}u.info("Text 2",n);const y=n.slice(1,n.length);let p=c.getBBox();const g=i.node().appendChild(R(y.join?y.join("<br/>"):y,t.labelStyle,!0,!0));if(H(B().flowchart.htmlLabels)){const k=g.children[0],x=T(g);o=k.getBoundingClientRect(),x.attr("width",o.width),x.attr("height",o.height)}const f=t.padding/2;return T(g).attr("transform","translate( "+(o.width>p.width?0:(p.width-o.width)/2)+", "+(p.height+f+5)+")"),T(c).attr("transform","translate( "+(o.width<p.width?0:-(p.width-o.width)/2)+", 0)"),o=i.node().getBBox(),i.attr("transform","translate("+-o.width/2+", "+(-o.height/2-f+3)+")"),l.attr("class","outer title-state").attr("x",-o.width/2-f).attr("y",-o.height/2-f).attr("width",o.width+t.padding).attr("height",o.height+t.padding),e.attr("class","divider").attr("x1",-o.width/2-f).attr("x2",o.width/2+f).attr("y1",-o.height/2-f+p.height+f).attr("y2",-o.height/2-f+p.height+f),m(t,l),t.intersect=function(k){return b.rect(t,k)},s},"rectWithTitle"),te=h(async(a,t)=>{const{shapeSvg:r,bbox:s}=await M(a,t,N(t,void 0),!0),l=s.height+t.padding,e=s.width+l/4+t.padding,i=r.insert("rect",":first-child").attr("style",t.style).attr("rx",l/2).attr("ry",l/2).attr("x",-e/2).attr("y",-l/2).attr("width",e).attr("height",l);return m(t,i),t.intersect=function(n){return b.rect(t,n)},r},"stadium"),ee=h(async(a,t)=>{const{shapeSvg:r,bbox:s,halfPadding:l}=await M(a,t,N(t,void 0),!0),e=r.insert("circle",":first-child");return e.attr("style",t.style).attr("rx",t.rx).attr("ry",t.ry).attr("r",s.width/2+l).attr("width",s.width+t.padding).attr("height",s.height+t.padding),u.info("Circle main"),m(t,e),t.intersect=function(i){return u.info("Circle intersect",t,s.width/2+l,i),b.circle(t,s.width/2+l,i)},r},"circle"),re=h(async(a,t)=>{const{shapeSvg:r,bbox:s,halfPadding:l}=await M(a,t,N(t,void 0),!0),e=5,i=r.insert("g",":first-child"),n=i.insert("circle"),d=i.insert("circle");return i.attr("class",t.class),n.attr("style",t.style).attr("rx",t.rx).attr("ry",t.ry).attr("r",s.width/2+l+e).attr("width",s.width+t.padding+e*2).attr("height",s.height+t.padding+e*2),d.attr("style",t.style).attr("rx",t.rx).attr("ry",t.ry).attr("r",s.width/2+l).attr("width",s.width+t.padding).attr("height",s.height+t.padding),u.info("DoubleCircle main"),m(t,n),t.intersect=function(c){return u.info("DoubleCircle intersect",t,s.width/2+l+e,c),b.circle(t,s.width/2+l+e,c)},r},"doublecircle"),ae=h(async(a,t)=>{const{shapeSvg:r,bbox:s}=await M(a,t,N(t,void 0),!0),l=s.width+t.padding,e=s.height+t.padding,i=[{x:0,y:0},{x:l,y:0},{x:l,y:-e},{x:0,y:-e},{x:0,y:0},{x:-8,y:0},{x:l+8,y:0},{x:l+8,y:-e},{x:-8,y:-e},{x:-8,y:0}],n=W(r,l,e,i);return n.attr("style",t.style),m(t,n),t.intersect=function(d){return b.polygon(t,i,d)},r},"subroutine"),ie=h((a,t)=>{const r=a.insert("g").attr("class","node default").attr("id",t.domId||t.id),s=r.insert("circle",":first-child");return s.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14),m(t,s),t.intersect=function(l){return b.circle(t,7,l)},r},"start"),tt=h((a,t,r)=>{const s=a.insert("g").attr("class","node default").attr("id",t.domId||t.id);let l=70,e=10;r==="LR"&&(l=10,e=70);const i=s.append("rect").attr("x",-1*l/2).attr("y",-1*e/2).attr("width",l).attr("height",e).attr("class","fork-join");return m(t,i),t.height=t.height+t.padding/2,t.width=t.width+t.padding/2,t.intersect=function(n){return b.rect(t,n)},s},"forkJoin"),ne=h((a,t)=>{const r=a.insert("g").attr("class","node default").attr("id",t.domId||t.id),s=r.insert("circle",":first-child"),l=r.insert("circle",":first-child");return l.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14),s.attr("class","state-end").attr("r",5).attr("width",10).attr("height",10),m(t,l),t.intersect=function(e){return b.circle(t,7,e)},r},"end"),se=h((a,t)=>{var J;const r=t.padding/2,s=4,l=8;let e;t.classes?e="node "+t.classes:e="node default";const i=a.insert("g").attr("class",e).attr("id",t.domId||t.id),n=i.insert("rect",":first-child"),d=i.insert("line"),c=i.insert("line");let o=0,y=s;const p=i.insert("g").attr("class","label");let g=0;const f=(J=t.classData.annotations)==null?void 0:J[0],k=t.classData.annotations[0]?"«"+t.classData.annotations[0]+"»":"",x=p.node().appendChild(R(k,t.labelStyle,!0,!0));let _=x.getBBox();if(H(B().flowchart.htmlLabels)){const L=x.children[0],v=T(x);_=L.getBoundingClientRect(),v.attr("width",_.width),v.attr("height",_.height)}t.classData.annotations[0]&&(y+=_.height+s,o+=_.width);let w=t.classData.label;t.classData.type!==void 0&&t.classData.type!==""&&(B().flowchart.htmlLabels?w+="&lt;"+t.classData.type+"&gt;":w+="<"+t.classData.type+">");const E=p.node().appendChild(R(w,t.labelStyle,!0,!0));T(E).attr("class","classTitle");let S=E.getBBox();if(H(B().flowchart.htmlLabels)){const L=E.children[0],v=T(E);S=L.getBoundingClientRect(),v.attr("width",S.width),v.attr("height",S.height)}y+=S.height+s,S.width>o&&(o=S.width);const D=[];t.classData.members.forEach(L=>{const v=L.getDisplayDetails();let $=v.displayText;B().flowchart.htmlLabels&&($=$.replace(/</g,"&lt;").replace(/>/g,"&gt;"));const I=p.node().appendChild(R($,v.cssStyle?v.cssStyle:t.labelStyle,!0,!0));let P=I.getBBox();if(H(B().flowchart.htmlLabels)){const Z=I.children[0],U=T(I);P=Z.getBoundingClientRect(),U.attr("width",P.width),U.attr("height",P.height)}P.width>o&&(o=P.width),y+=P.height+s,D.push(I)}),y+=l;const X=[];if(t.classData.methods.forEach(L=>{const v=L.getDisplayDetails();let $=v.displayText;B().flowchart.htmlLabels&&($=$.replace(/</g,"&lt;").replace(/>/g,"&gt;"));const I=p.node().appendChild(R($,v.cssStyle?v.cssStyle:t.labelStyle,!0,!0));let P=I.getBBox();if(H(B().flowchart.htmlLabels)){const Z=I.children[0],U=T(I);P=Z.getBoundingClientRect(),U.attr("width",P.width),U.attr("height",P.height)}P.width>o&&(o=P.width),y+=P.height+s,X.push(I)}),y+=l,f){let L=(o-_.width)/2;T(x).attr("transform","translate( "+(-1*o/2+L)+", "+-1*y/2+")"),g=_.height+s}let yt=(o-S.width)/2;return T(E).attr("transform","translate( "+(-1*o/2+yt)+", "+(-1*y/2+g)+")"),g+=S.height+s,d.attr("class","divider").attr("x1",-o/2-r).attr("x2",o/2+r).attr("y1",-y/2-r+l+g).attr("y2",-y/2-r+l+g),g+=l,D.forEach(L=>{var $;T(L).attr("transform","translate( "+-o/2+", "+(-1*y/2+g+l/2)+")");const v=L==null?void 0:L.getBBox();g+=(($=v==null?void 0:v.height)!=null?$:0)+s}),g+=l,c.attr("class","divider").attr("x1",-o/2-r).attr("x2",o/2+r).attr("y1",-y/2-r+l+g).attr("y2",-y/2-r+l+g),g+=l,X.forEach(L=>{var $;T(L).attr("transform","translate( "+-o/2+", "+(-1*y/2+g)+")");const v=L==null?void 0:L.getBBox();g+=(($=v==null?void 0:v.height)!=null?$:0)+s}),n.attr("style",t.style).attr("class","outer title-state").attr("x",-o/2-r).attr("y",-(y/2)-r).attr("width",o+t.padding).attr("height",y+t.padding),m(t,n),t.intersect=function(L){return b.rect(t,L)},i},"class_box"),et={rhombus:K,composite:Qt,question:K,rect:Jt,labelRect:Gt,rectWithTitle:Kt,choice:Xt,circle:ee,doublecircle:re,stadium:te,hexagon:Ut,block_arrow:At,rect_left_inv_arrow:jt,lean_right:Ot,lean_left:zt,trapezoid:Zt,inv_trapezoid:qt,rect_right_inv_arrow:Vt,cylinder:Ft,start:ie,end:ne,note:Yt,subroutine:ae,fork:tt,join:tt,class_box:se},Y={},pe=h(async(a,t,r)=>{let s,l;if(t.link){let e;B().securityLevel==="sandbox"?e="_top":t.linkTarget&&(e=t.linkTarget||"_blank"),s=a.insert("svg:a").attr("xlink:href",t.link).attr("target",e),l=await et[t.shape](s,t,r)}else l=await et[t.shape](a,t,r),s=l;return t.tooltip&&l.attr("title",t.tooltip),t.class&&l.attr("class","node default "+t.class),Y[t.id]=s,t.haveCallback&&Y[t.id].attr("class",Y[t.id].attr("class")+" clickable"),s},"insertNode"),ge=h((a,t)=>{Y[t.id]=a},"setNodeElem"),xe=h(()=>{Y={}},"clear"),fe=h(a=>{const t=Y[a.id];u.trace("Transforming node",a.diff,a,"translate("+(a.x-a.width/2-5)+", "+a.width/2+")");const r=8,s=a.diff||0;return a.clusterNode?t.attr("transform","translate("+(a.x+s-a.width/2)+", "+(a.y-a.height/2-r)+")"):t.attr("transform","translate("+a.x+", "+a.y+")"),s},"positionNode"),le=h((a,t,r,s,l)=>{t.arrowTypeStart&&rt(a,"start",t.arrowTypeStart,r,s,l),t.arrowTypeEnd&&rt(a,"end",t.arrowTypeEnd,r,s,l)},"addEdgeMarkers"),de={arrow_cross:"cross",arrow_point:"point",arrow_barb:"barb",arrow_circle:"circle",aggregation:"aggregation",extension:"extension",composition:"composition",dependency:"dependency",lollipop:"lollipop"},rt=h((a,t,r,s,l,e)=>{const i=de[r];if(!i){u.warn("Unknown arrow type: ".concat(r));return}const n=t==="start"?"Start":"End";a.attr("marker-".concat(t),"url(".concat(s,"#").concat(l,"_").concat(e,"-").concat(i).concat(n,")"))},"addEdgeMarker"),O={},C={},ue=h(()=>{O={},C={}},"clear"),we=h((a,t)=>{const r=B(),s=H(r.flowchart.htmlLabels),l=t.labelType==="markdown"?it(a,t.label,{style:t.labelStyle,useHtmlLabels:s,addSvgBackground:!0},r):R(t.label,t.labelStyle),e=a.insert("g").attr("class","edgeLabel"),i=e.insert("g").attr("class","label");i.node().appendChild(l);let n=l.getBBox();if(s){const c=l.children[0],o=T(l);n=c.getBoundingClientRect(),o.attr("width",n.width),o.attr("height",n.height)}i.attr("transform","translate("+-n.width/2+", "+-n.height/2+")"),O[t.id]=e,t.width=n.width,t.height=n.height;let d;if(t.startLabelLeft){const c=R(t.startLabelLeft,t.labelStyle),o=a.insert("g").attr("class","edgeTerminals"),y=o.insert("g").attr("class","inner");d=y.node().appendChild(c);const p=c.getBBox();y.attr("transform","translate("+-p.width/2+", "+-p.height/2+")"),C[t.id]||(C[t.id]={}),C[t.id].startLeft=o,j(d,t.startLabelLeft)}if(t.startLabelRight){const c=R(t.startLabelRight,t.labelStyle),o=a.insert("g").attr("class","edgeTerminals"),y=o.insert("g").attr("class","inner");d=o.node().appendChild(c),y.node().appendChild(c);const p=c.getBBox();y.attr("transform","translate("+-p.width/2+", "+-p.height/2+")"),C[t.id]||(C[t.id]={}),C[t.id].startRight=o,j(d,t.startLabelRight)}if(t.endLabelLeft){const c=R(t.endLabelLeft,t.labelStyle),o=a.insert("g").attr("class","edgeTerminals"),y=o.insert("g").attr("class","inner");d=y.node().appendChild(c);const p=c.getBBox();y.attr("transform","translate("+-p.width/2+", "+-p.height/2+")"),o.node().appendChild(c),C[t.id]||(C[t.id]={}),C[t.id].endLeft=o,j(d,t.endLabelLeft)}if(t.endLabelRight){const c=R(t.endLabelRight,t.labelStyle),o=a.insert("g").attr("class","edgeTerminals"),y=o.insert("g").attr("class","inner");d=y.node().appendChild(c);const p=c.getBBox();y.attr("transform","translate("+-p.width/2+", "+-p.height/2+")"),o.node().appendChild(c),C[t.id]||(C[t.id]={}),C[t.id].endRight=o,j(d,t.endLabelRight)}return l},"insertEdgeLabel");function j(a,t){B().flowchart.htmlLabels&&a&&(a.style.width=t.length*9+"px",a.style.height="12px")}h(j,"setTerminalWidth");var be=h((a,t)=>{u.debug("Moving label abc88 ",a.id,a.label,O[a.id],t);let r=t.updatedPath?t.updatedPath:t.originalPath;const s=B(),{subGraphTitleTotalMargin:l}=pt(s);if(a.label){const e=O[a.id];let i=a.x,n=a.y;if(r){const d=A.calcLabelPosition(r);u.debug("Moving label "+a.label+" from (",i,",",n,") to (",d.x,",",d.y,") abc88"),t.updatedPath&&(i=d.x,n=d.y)}e.attr("transform","translate(".concat(i,", ").concat(n+l/2,")"))}if(a.startLabelLeft){const e=C[a.id].startLeft;let i=a.x,n=a.y;if(r){const d=A.calcTerminalLabelPosition(a.arrowTypeStart?10:0,"start_left",r);i=d.x,n=d.y}e.attr("transform","translate(".concat(i,", ").concat(n,")"))}if(a.startLabelRight){const e=C[a.id].startRight;let i=a.x,n=a.y;if(r){const d=A.calcTerminalLabelPosition(a.arrowTypeStart?10:0,"start_right",r);i=d.x,n=d.y}e.attr("transform","translate(".concat(i,", ").concat(n,")"))}if(a.endLabelLeft){const e=C[a.id].endLeft;let i=a.x,n=a.y;if(r){const d=A.calcTerminalLabelPosition(a.arrowTypeEnd?10:0,"end_left",r);i=d.x,n=d.y}e.attr("transform","translate(".concat(i,", ").concat(n,")"))}if(a.endLabelRight){const e=C[a.id].endRight;let i=a.x,n=a.y;if(r){const d=A.calcTerminalLabelPosition(a.arrowTypeEnd?10:0,"end_right",r);i=d.x,n=d.y}e.attr("transform","translate(".concat(i,", ").concat(n,")"))}},"positionEdgeLabel"),oe=h((a,t)=>{const r=a.x,s=a.y,l=Math.abs(t.x-r),e=Math.abs(t.y-s),i=a.width/2,n=a.height/2;return l>=i||e>=n},"outsideNode"),ce=h((a,t,r)=>{u.debug("intersection calc abc89:\n  outsidePoint: ".concat(JSON.stringify(t),"\n  insidePoint : ").concat(JSON.stringify(r),"\n  node        : x:").concat(a.x," y:").concat(a.y," w:").concat(a.width," h:").concat(a.height));const s=a.x,l=a.y,e=Math.abs(s-r.x),i=a.width/2;let n=r.x<t.x?i-e:i+e;const d=a.height/2,c=Math.abs(t.y-r.y),o=Math.abs(t.x-r.x);if(Math.abs(l-t.y)*i>Math.abs(s-t.x)*d){let y=r.y<t.y?t.y-d-l:l-d-t.y;n=o*y/c;const p={x:r.x<t.x?r.x+n:r.x-o+n,y:r.y<t.y?r.y+c-y:r.y-c+y};return n===0&&(p.x=t.x,p.y=t.y),o===0&&(p.x=t.x),c===0&&(p.y=t.y),u.debug("abc89 topp/bott calc, Q ".concat(c,", q ").concat(y,", R ").concat(o,", r ").concat(n),p),p}else{r.x<t.x?n=t.x-i-s:n=s-i-t.x;let y=c*n/o,p=r.x<t.x?r.x+o-n:r.x-o+n,g=r.y<t.y?r.y+y:r.y-y;return u.debug("sides calc abc89, Q ".concat(c,", q ").concat(y,", R ").concat(o,", r ").concat(n),{_x:p,_y:g}),n===0&&(p=t.x,g=t.y),o===0&&(p=t.x),c===0&&(g=t.y),{x:p,y:g}}},"intersection"),at=h((a,t)=>{u.debug("abc88 cutPathAtIntersect",a,t);let r=[],s=a[0],l=!1;return a.forEach(e=>{if(!oe(t,e)&&!l){const i=ce(t,s,e);let n=!1;r.forEach(d=>{n=n||d.x===i.x&&d.y===i.y}),r.some(d=>d.x===i.x&&d.y===i.y)||r.push(i),l=!0}else s=e,l||r.push(e)}),r},"cutPathAtIntersect"),me=h(function(a,t,r,s,l,e,i){let n=r.points;u.debug("abc88 InsertEdge: edge=",r,"e=",t);let d=!1;const c=e.node(t.v);var o=e.node(t.w);o!=null&&o.intersect&&(c!=null&&c.intersect)&&(n=n.slice(1,r.points.length-1),n.unshift(c.intersect(n[0])),n.push(o.intersect(n[n.length-1]))),r.toCluster&&(u.debug("to cluster abc88",s[r.toCluster]),n=at(r.points,s[r.toCluster].node),d=!0),r.fromCluster&&(u.debug("from cluster abc88",s[r.fromCluster]),n=at(n.reverse(),s[r.fromCluster].node).reverse(),d=!0);const y=n.filter(S=>!Number.isNaN(S.y));let p=ft;r.curve&&(l==="graph"||l==="flowchart")&&(p=r.curve);const{x:g,y:f}=gt(r),k=xt().x(g).y(f).curve(p);let x;switch(r.thickness){case"normal":x="edge-thickness-normal";break;case"thick":x="edge-thickness-thick";break;case"invisible":x="edge-thickness-thick";break;default:x=""}switch(r.pattern){case"solid":x+=" edge-pattern-solid";break;case"dotted":x+=" edge-pattern-dotted";break;case"dashed":x+=" edge-pattern-dashed";break}const _=a.append("path").attr("d",k(y)).attr("id",r.id).attr("class"," "+x+(r.classes?" "+r.classes:"")).attr("style",r.style);let w="";(B().flowchart.arrowMarkerAbsolute||B().state.arrowMarkerAbsolute)&&(w=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,w=w.replace(/\(/g,"\\("),w=w.replace(/\)/g,"\\)")),le(_,r,w,i,l);let E={};return d&&(E.updatedPath=n),E.originalPath=r.points,E},"insertEdge");export{ue as a,we as b,xe as c,me as d,be as e,R as f,It as g,pe as i,ye as m,fe as p,ge as s,m as u};
