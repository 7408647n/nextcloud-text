/*! third party licenses: js/vendor.LICENSE.txt */
import{p as G,d as C,s as P}from"./styles-b83b31c9-B9Y1De5o.mjs";import{al as c,ag as d,ak as v,aD as q,aw as z,as as M,av as _,ar as $,ao as B}from"./RichText-XnmIhYcE.mjs";import{G as H}from"./graph-C0h-oZ_P.mjs";import{r as O}from"./index-01f381cb-gAIu7YvR.mjs";import"./NcNoteCard-e7-Bxio8-DX1UPUdy.mjs";import"./layout-ZFSmlYqJ.mjs";import"./NcTextArea-XCi8a16Y-CFSsbK92.mjs";import"./vue.runtime.esm-Dd7ivler.mjs";import"./index-vg7q3Iku.mjs";import"./index-DMlkRGZt.mjs";import"./modulepreload-polyfill-DZeoc1eZ.mjs";import"./index-eMgxgA-0.mjs";import"./index-7dlE0du4.mjs";import"./index-Ubm2itxG.mjs";import"./MediaHandler.provider-2sdLyJv2.mjs";import"./logger-2teHUPfo.mjs";import"./_plugin-vue2_normalizer-BWKvF6pj.mjs";import"./clone-CVzRJUy_.mjs";import"./edges-066a5561-D8bXQgev.mjs";import"./createText-ca0c5216-BGmp-gPk.mjs";import"./line-CLBmkMev.mjs";import"./array-CNYCUCI1.mjs";import"./path-D16fQfbf.mjs";const T=l=>B.sanitizeText(l,d());let k={dividerMargin:10,padding:5,textHeight:10,curve:void 0};const W=function(l,a,b,s){const e=Object.keys(l);c.info("keys:",e),c.info(l),e.forEach(function(n){var p;var o,r;const t=l[n],i={shape:"rect",id:t.id,domId:t.domId,labelText:T(t.id),labelStyle:"",style:"fill: none; stroke: black",padding:(p=(o=d().flowchart)==null?void 0:o.padding)!=null?p:(r=d().class)==null?void 0:r.padding};a.setNode(t.id,i),R(t.classes,a,b,s,t.id),c.info("setNode",i)})},R=function(l,a,b,s,e){const n=Object.keys(l);c.info("keys:",n),c.info(l),n.filter(o=>l[o].parent==e).forEach(function(o){var m,u;var r,t;const i=l[o],p=i.cssClasses.join(" "),y=M(i.styles),h=(m=i.label)!=null?m:i.id,f=0,g={labelStyle:y.labelStyle,shape:"class_box",labelText:T(h),classData:i,rx:f,ry:f,class:p,style:y.style,id:i.id,domId:i.domId,tooltip:s.db.getTooltip(i.id,e)||"",haveCallback:i.haveCallback,link:i.link,width:i.type==="group"?500:void 0,type:i.type,padding:(u=(r=d().flowchart)==null?void 0:r.padding)!=null?u:(t=d().class)==null?void 0:t.padding};a.setNode(i.id,g),e&&a.setParent(i.id,e),c.info("setNode",g)})},F=function(l,a,b,s){c.info(l),l.forEach(function(e,n){var u;var o,r;const t=e,i="",p={labelStyle:"",style:""},y=t.text,h=0,f={labelStyle:p.labelStyle,shape:"note",labelText:T(y),noteData:t,rx:h,ry:h,class:i,style:p.style,id:t.id,domId:t.id,tooltip:"",type:"note",padding:(u=(o=d().flowchart)==null?void 0:o.padding)!=null?u:(r=d().class)==null?void 0:r.padding};if(a.setNode(t.id,f),c.info("setNode",f),!t.class||!(t.class in s))return;const g=b+n,m={id:"edgeNote".concat(g),classes:"relation",pattern:"dotted",arrowhead:"none",startLabelRight:"",endLabelLeft:"",arrowTypeStart:"none",arrowTypeEnd:"none",style:"fill:none",labelStyle:"",curve:_(k.curve,$)};a.setEdge(t.id,t.class,m,g)})},J=function(l,a){const b=d().flowchart;let s=0;l.forEach(function(e){var r;var n;s++;const o={classes:"relation",pattern:e.relation.lineType==1?"dashed":"solid",id:"id_".concat(e.id1,"_").concat(e.id2,"_").concat(s),arrowhead:e.type==="arrow_open"?"none":"normal",startLabelRight:e.relationTitle1==="none"?"":e.relationTitle1,endLabelLeft:e.relationTitle2==="none"?"":e.relationTitle2,arrowTypeStart:I(e.relation.type1),arrowTypeEnd:I(e.relation.type2),style:"fill:none",labelStyle:"",curve:_(b==null?void 0:b.curve,$)};if(c.info(o,e),e.style!==void 0){const t=M(e.style);o.style=t.style,o.labelStyle=t.labelStyle}e.text=e.title,e.text===void 0?e.style!==void 0&&(o.arrowheadStyle="fill: #333"):(o.arrowheadStyle="fill: #333",o.labelpos="c",((r=(n=d().flowchart)==null?void 0:n.htmlLabels)!=null?r:d().htmlLabels)?(o.labelType="html",o.label='<span class="edgeLabel">'+e.text+"</span>"):(o.labelType="text",o.label=e.text.replace(B.lineBreakRegex,"\n"),e.style===void 0&&(o.style=o.style||"stroke: #333; stroke-width: 1.5px;fill:none"),o.labelStyle=o.labelStyle.replace("color:","fill:"))),a.setEdge(e.id1,e.id2,o,s)})},K=function(l){k={...k,...l}},Q=async function(l,a,b,s){var S,L,D,E;c.info("Drawing class - ",a);const e=(S=d().flowchart)!=null?S:d().class,n=d().securityLevel;c.info("config:",e);const o=(L=e==null?void 0:e.nodeSpacing)!=null?L:50,r=(D=e==null?void 0:e.rankSpacing)!=null?D:50,t=new H({multigraph:!0,compound:!0}).setGraph({rankdir:s.db.getDirection(),nodesep:o,ranksep:r,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}}),i=s.db.getNamespaces(),p=s.db.getClasses(),y=s.db.getRelations(),h=s.db.getNotes();c.info(y),W(i,t,a,s),R(p,t,a,s),J(y,t),F(h,t,y.length+1,p);let f;n==="sandbox"&&(f=v("#i"+a));const g=n==="sandbox"?v(f.nodes()[0].contentDocument.body):v("body"),m=g.select('[id="'.concat(a,'"]')),u=g.select("#"+a+" g");if(await O(u,t,["aggregation","extension","composition","dependency","lollipop"],"classDiagram",a),q.insertTitle(m,"classTitleText",(E=e==null?void 0:e.titleTopMargin)!=null?E:5,s.db.getDiagramTitle()),z(t,m,e==null?void 0:e.diagramPadding,e==null?void 0:e.useMaxWidth),!(e!=null&&e.htmlLabels)){const N=n==="sandbox"?f.nodes()[0].contentDocument:document,j=N.querySelectorAll('[id="'+a+'"] .edgeLabel .label');for(const x of j){const A=x.getBBox(),w=N.createElementNS("http://www.w3.org/2000/svg","rect");w.setAttribute("rx",0),w.setAttribute("ry",0),w.setAttribute("width",A.width),w.setAttribute("height",A.height),x.insertBefore(w,x.firstChild)}}};function I(l){let a;switch(l){case 0:a="aggregation";break;case 1:a="extension";break;case 2:a="composition";break;case 3:a="dependency";break;case 4:a="lollipop";break;default:a="none"}return a}const U={setConf:K,draw:Q},we={parser:G,db:C,renderer:U,styles:P,init:l=>{l.class||(l.class={}),l.class.arrowMarkerAbsolute=l.arrowMarkerAbsolute,C.clear()}};export{we as diagram};
